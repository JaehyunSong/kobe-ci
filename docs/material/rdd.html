<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>回帰不連続デザイン – Causal Inference@Kobe</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../material/did.html" rel="prev">
<link href="../figs/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "一致なし",
    "search-matching-documents-text": "一致した文書",
    "search-copy-link-title": "検索へのリンクをコピー",
    "search-hide-matches-text": "追加の検索結果を非表示",
    "search-more-match-text": "追加の検索結果",
    "search-more-matches-text": "追加の検索結果",
    "search-clear-button-title": "消去",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "検索",
    "search-label": "サーチ"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9F94XL4N4M"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-9F94XL4N4M', { 'anonymize_ip': true});
</script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&amp;display=swap" rel="stylesheet"> 
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono&amp;display=swap" rel="stylesheet"> 

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Jaehyun Song, Ph.D.">
<meta property="og:description" content="Causal Inference@Kobe">
<meta property="og:image" content="https://www.jaysong.net/kobe-ci/material/imgs/favicon.png">
<meta property="og:site_name" content="Causal Inference@Kobe">
<meta name="twitter:title" content="Jaehyun Song, Ph.D.">
<meta name="twitter:description" content="Causal Inference@Kobe">
<meta name="twitter:image" content="https://www.jaysong.net/kobe-ci/material/imgs/favicon.png">
<meta name="twitter:creator" content="@Tintstyle">
<meta name="twitter:site" content="@Tintstyle">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../figs/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Causal Inference@Kobe</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="サーチ"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="ナビゲーションを切り替える" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">シラバス</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-">    
        <li>
    <a class="dropdown-item" href="../syllabus/syllabus.html">
 <span class="dropdown-text">シラバス</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../syllabus/dataset.html">
 <span class="dropdown-text">データセットについて</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-rの使い方" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Rの使い方</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-rの使い方">    
        <li>
    <a class="dropdown-item" href="../intro/install.html">
 <span class="dropdown-text">Rの導入</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../intro/project.html">
 <span class="dropdown-text">プロジェクト管理</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../intro/file.html">
 <span class="dropdown-text">ファイル管理</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../intro/filesystem.html">
 <span class="dropdown-text">ファイル・システム</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../intro/packages.html">
 <span class="dropdown-text">パッケージ</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">講義資料</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--1">    
        <li>
    <a class="dropdown-item" href="../material/intro_rct.html">
 <span class="dropdown-text">因果推論の考え方とランダム化比較試験</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../material/matching.html">
 <span class="dropdown-text">マッチング</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../material/did.html">
 <span class="dropdown-text">差分の差分法</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../material/rdd.html">
 <span class="dropdown-text">回帰不連続デザイン</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://jupyter.cs.rcos.nii.ac.jp/" target="_blank"> <i class="bi bi-terminal" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.jaysong.net/RBook/" target="_blank"> <i class="bi bi-book" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="サイドバーを切り替える" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../material/rdd.html">回帰不連続デザイン</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="サイドバーを切り替える" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../material/intro_rct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">因果推論の考え方とランダム化比較試験</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../material/matching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">マッチング</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../material/did.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">差分の差分法</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../material/rdd.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">回帰不連続デザイン</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#スライド" id="toc-スライド" class="nav-link active" data-scroll-target="#スライド">スライド</a></li>
  <li><a href="#セットアップ" id="toc-セットアップ" class="nav-link" data-scroll-target="#セットアップ">セットアップ</a></li>
  <li><a href="#処置効果の推定" id="toc-処置効果の推定" class="nav-link" data-scroll-target="#処置効果の推定">処置効果の推定</a></li>
  <li><a href="#頑健性の確認" id="toc-頑健性の確認" class="nav-link" data-scroll-target="#頑健性の確認">頑健性の確認</a>
  <ul class="collapse">
  <li><a href="#バンド幅" id="toc-バンド幅" class="nav-link" data-scroll-target="#バンド幅">バンド幅</a></li>
  <li><a href="#カーネル" id="toc-カーネル" class="nav-link" data-scroll-target="#カーネル">カーネル</a></li>
  <li><a href="#関数" id="toc-関数" class="nav-link" data-scroll-target="#関数">関数</a></li>
  </ul></li>
  <li><a href="#可視化" id="toc-可視化" class="nav-link" data-scroll-target="#可視化">可視化</a></li>
  <li><a href="#仮定の確認" id="toc-仮定の確認" class="nav-link" data-scroll-target="#仮定の確認">仮定の確認</a>
  <ul class="collapse">
  <li><a href="#交絡要因の連続性" id="toc-交絡要因の連続性" class="nav-link" data-scroll-target="#交絡要因の連続性">交絡要因の連続性</a></li>
  <li><a href="#バランスチェック" id="toc-バランスチェック" class="nav-link" data-scroll-target="#バランスチェック">バランスチェック</a></li>
  <li><a href="#強制変数の操作可能性" id="toc-強制変数の操作可能性" class="nav-link" data-scroll-target="#強制変数の操作可能性">強制変数の操作可能性</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">回帰不連続デザイン</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="スライド" class="level2">
<h2 class="anchored" data-anchor-id="スライド">スライド</h2>
<p><a href="../slide/rdd.html" class="btn btn-primary btn-sm" target="_blank" role="button"><i class="bi bi-window"></i> 新しいタブで開く</a></p>
<iframe class="slide-deck" src="../slide/rdd.html" width="100%" style="aspect-ratio: 16 / 9.2;"></iframe>
</section>
<section id="セットアップ" class="level2">
<h2 class="anchored" data-anchor-id="セットアップ">セットアップ</h2>
<p>実習に必要なパッケージとデータセットを読み込む。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, rdd, rdrobust, rddensity, </span>
<span id="cb1-2"><a href="#cb1-2"></a>               summarytools, BalanceR)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/rdd_data4.csv"</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a>df</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,266 × 7
    year prefname outcome      rv total_cand en_cand total_votes
   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;
 1  2000 Hokkaido    34.6 -10.8            4    2.75      261382
 2  2003 Hokkaido    40.8 -10.4            3    2.29      259740
 3  2005 Hokkaido    36.8  -2.45           4    2.60      313909
 4  2009 Hokkaido    31.1  -8.72           4    2.29      337445
 5  2012 Hokkaido    39.6   1.09           5    4.17      276894
 6  2000 Hokkaido    35.3   2.52           6    4.19      244655
 7  2003 Hokkaido    44.5  -5.13           5    2.86      236430
 8  2005 Hokkaido    30.8  -0.407          3    2.42      285519
 9  2009 Hokkaido    35.0 -11.7            5    2.50      304810
10  2012 Hokkaido    38.8   5.87           5    4.17      239023
# ℹ 1,256 more rows</code></pre>
</div>
</div>
<p>分析に入る前に記述統計を確認する。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">descr</span>(<span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"n.valid"</span>),</span>
<span id="cb3-3"><a href="#cb3-3"></a>        <span class="at">transpose =</span> <span class="cn">TRUE</span>, <span class="at">order =</span> <span class="st">"p"</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Descriptive Statistics  
df  
N: 1266  

                         Mean    Std.Dev         Min         Max   N.Valid
----------------- ----------- ---------- ----------- ----------- ---------
             year     2006.18       4.20     2000.00     2012.00   1266.00
          outcome       47.02      11.65       13.26       84.50   1266.00
               rv        3.58      10.20      -23.76       36.31   1266.00
       total_cand        3.76       0.95        2.00        9.00   1266.00
          en_cand        2.55       0.59        1.37        5.35   1266.00
      total_votes   214025.95   42366.82   104398.00   339780.00   1266.00</code></pre>
</div>
</div>
</section>
<section id="処置効果の推定" class="level2">
<h2 class="anchored" data-anchor-id="処置効果の推定">処置効果の推定</h2>
<p>　因果効果の推定は{rdd}パッケージの<code>RDestimate()</code>関数、あるいは{rdrobust}パッケージの<code>rdrobust()</code>を使う。機能面では{rdrobust}の方が優れているものの、パッケージの使いやすさとしては{rdd}の方が優れている。本講義では頑健な推定方法については紹介しなかったものの、近年は{rdrobust}がより使われているため、ここでも{rdrobust}を使用する。いずれのパッケージも自動的に最適バンド幅を設定し<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>、<strong>交差項</strong>が含まれた局所<strong>線形</strong>回帰分析を行った結果を返してくれる<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>。また、デフォルトのカーネルは三角 (triangular)カーネル関数だ。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>rdd_fit1 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">summary</span>(rdd_fit1)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             318          381
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   8.064        8.064
BW bias (b)                  12.613       12.613
rho (h/b)                     0.639        0.639
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional     0.725     1.580     0.459     0.646    [-2.371 , 3.820]     
        Robust         -         -     0.528     0.598    [-2.692 , 4.677]     
=============================================================================</code></pre>
</div>
</div>
<p>　最適バンド幅は8.064であり、処置効果は約0.725である。これは自民党候補者の投票率から非自民候補者の最高得票率を引いた値（<code>rv</code>）が-8.064から8.064までのデータを使うことを意味する。そして、これらのデータに対して交差項が含まれる線形回帰分析を行うことになる。また、閾値周辺に重みを付けるために三角カーネル関数による重み付けを行った。</p>
<p>　結果として現職は新人に比べ、約72.5%ポイント得票率が高いという結果が得られたが、標準誤差はかなり大きく、必ずしも現職が新人より得票するとは言えないだろう（<span class="math inline">\(p\)</span> = 0.646）。今回の推定結果から日本における現職効果について、<strong>統計的</strong>に有意な効果は確認できない。</p>
</section>
<section id="頑健性の確認" class="level2">
<h2 class="anchored" data-anchor-id="頑健性の確認">頑健性の確認</h2>
<p>　RDDで（局所）処置効果を推定する際、分析する側はバンド幅、カーネル関数、モデル（一次関数か、二次関数かなど）を決める必要がある。これらは恣意的なものであるため、これらを少し変更しても推定値が安定しているか、つまりどれほど頑健かを確認する必要がある。</p>
<section id="バンド幅" class="level3">
<h3 class="anchored" data-anchor-id="バンド幅">バンド幅</h3>
<p>　<code>rdrobust()</code>の場合、基本的には最適バンド幅を使うことになるが、<code>h</code>引数を使って任意のバンド幅を指定することもできる。たとえば、既に得られた最適バンド幅8.064を使って推定してみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>rdd_bw1 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">8.064</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">summary</span>(rdd_bw1)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                      Manual
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             318          381
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   8.064        8.064
BW bias (b)                   8.064        8.064
rho (h/b)                     1.000        1.000
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional     0.725     1.580     0.459     0.646    [-2.371 , 3.820]     
        Robust         -         -     0.013     0.990    [-4.461 , 4.521]     
=============================================================================</code></pre>
</div>
</div>
<p>　先ほどと同じ結果が得られている（Robust行はこの講義では無視する。Robust推定値についてはCalonico et al.&nbsp;(2015)を参照されたい<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>。）。頑健性を報告する際は最適バンド幅における処置効果に加え、最適バンド幅を半分にした場合、2倍にした場合の結果も報告するケースが多い。それでは<code>h</code>を8.064の半分、2倍にしたモデルも推定してみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>rdd_bw2 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">8.064</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="fu">summary</span>(rdd_bw2)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                      Manual
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             188          185
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   4.032        4.032
BW bias (b)                   4.032        4.032
rho (h/b)                     1.000        1.000
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional     0.162     2.205     0.074     0.941    [-4.160 , 4.485]     
        Robust         -         -     0.316     0.752    [-5.326 , 7.375]     
=============================================================================</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>rdd_bw3 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">8.064</span> <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="fu">summary</span>(rdd_bw3)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                      Manual
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             453          650
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                  16.128       16.128
BW bias (b)                  16.128       16.128
rho (h/b)                     1.000        1.000
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional    -0.006     1.141    -0.005     0.996    [-2.242 , 2.229]     
        Robust         -         -     0.580     0.562    [-2.309 , 4.250]     
=============================================================================</code></pre>
</div>
</div>
<p>　いずれも統計的に有意な処置効果は得られない。これらの結果をまとめると以下のよるになる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>bw_compare <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Bandwidth =</span> <span class="fu">c</span>(<span class="st">"Half"</span>, <span class="st">"Optimal"</span>, <span class="st">"Double"</span>),</span>
<span id="cb13-2"><a href="#cb13-2"></a>                     <span class="at">LATE      =</span> <span class="fu">c</span>(<span class="fl">0.162</span>, <span class="fl">0.725</span>, <span class="sc">-</span><span class="fl">0.006</span>),</span>
<span id="cb13-3"><a href="#cb13-3"></a>                     <span class="at">lower     =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.160</span>, <span class="sc">-</span><span class="fl">2.371</span>, <span class="sc">-</span><span class="fl">2.242</span>),</span>
<span id="cb13-4"><a href="#cb13-4"></a>                     <span class="at">upper     =</span> <span class="fu">c</span>(<span class="fl">4.485</span>, <span class="fl">3.820</span>, <span class="fl">2.2249</span>))</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a>bw_compare</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Bandwidth   LATE lower upper
  &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Half       0.162 -4.16  4.49
2 Optimal    0.725 -2.37  3.82
3 Double    -0.006 -2.24  2.22</code></pre>
</div>
</div>
<p>　これらをpoint-rangeプロットで可視化してみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>bw_compare <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">mutate</span>(<span class="at">Bandwidth =</span> <span class="fu">fct_inorder</span>(Bandwidth)) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> Bandwidth, <span class="at">y =</span> LATE, </span>
<span id="cb15-6"><a href="#cb15-6"></a>                      <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">12</span>) </span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rdd_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="カーネル" class="level3">
<h3 class="anchored" data-anchor-id="カーネル">カーネル</h3>
<p>　カーネル関数は<code>kernel</code>引数で指定することができる。指定しない場合、既定値として<code>kernel = "triangular"</code>になるが、他にも<code>"uniform"</code>と<code>"epanechnikov"</code>がある。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>rdd_kernel1 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, </span>
<span id="cb16-2"><a href="#cb16-2"></a>                        <span class="at">kernel =</span> <span class="st">"triangular"</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a>rdd_kernel2 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, </span>
<span id="cb16-4"><a href="#cb16-4"></a>                        <span class="at">kernel =</span> <span class="st">"uniform"</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a>rdd_kernel3 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, </span>
<span id="cb16-6"><a href="#cb16-6"></a>                        <span class="at">kernel =</span> <span class="st">"epanechnikov"</span>)</span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="fu">summary</span>(rdd_kernel1)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             318          381
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   8.064        8.064
BW bias (b)                  12.613       12.613
rho (h/b)                     0.639        0.639
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional     0.725     1.580     0.459     0.646    [-2.371 , 3.820]     
        Robust         -         -     0.528     0.598    [-2.692 , 4.677]     
=============================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">summary</span>(rdd_kernel2)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                       mserd
Kernel                      Uniform
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             245          264
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   5.651        5.651
BW bias (b)                  10.115       10.115
rho (h/b)                     0.559        0.559
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional     0.611     1.699     0.360     0.719    [-2.718 , 3.941]     
        Robust         -         -     0.516     0.606    [-2.878 , 4.933]     
=============================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">summary</span>(rdd_kernel3)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                       mserd
Kernel                   Epanechnikov
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             298          349
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   7.420        7.420
BW bias (b)                  12.211       12.211
rho (h/b)                     0.608        0.608
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional     0.722     1.586     0.455     0.649    [-2.387 , 3.832]     
        Robust         -         -     0.560     0.575    [-2.633 , 4.740]     
=============================================================================</code></pre>
</div>
</div>
<p>　以上の結果をまとめたものが以下である。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>kernel_compare <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">"Triangular"</span>, </span>
<span id="cb22-2"><a href="#cb22-2"></a>                                    <span class="st">"Unifrom"</span>, </span>
<span id="cb22-3"><a href="#cb22-3"></a>                                    <span class="st">"Epanechnikov"</span>),</span>
<span id="cb22-4"><a href="#cb22-4"></a>                         <span class="at">LATE   =</span> <span class="fu">c</span>(<span class="fl">0.725</span>, <span class="fl">0.611</span>, <span class="fl">0.722</span>),</span>
<span id="cb22-5"><a href="#cb22-5"></a>                         <span class="at">lower  =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.371</span>, <span class="sc">-</span><span class="fl">2.718</span>, <span class="sc">-</span><span class="fl">2.387</span>),</span>
<span id="cb22-6"><a href="#cb22-6"></a>                         <span class="at">upper  =</span> <span class="fu">c</span>(<span class="fl">3.820</span>, <span class="fl">3.941</span>, <span class="fl">3.832</span>))</span>
<span id="cb22-7"><a href="#cb22-7"></a></span>
<span id="cb22-8"><a href="#cb22-8"></a>kernel_compare</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Kernel        LATE lower upper
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Triangular   0.725 -2.37  3.82
2 Unifrom      0.611 -2.72  3.94
3 Epanechnikov 0.722 -2.39  3.83</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>kernel_compare <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">mutate</span>(<span class="at">Kernel =</span> <span class="fu">fct_inorder</span>(Kernel)) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> Kernel, <span class="at">y =</span> LATE, </span>
<span id="cb24-6"><a href="#cb24-6"></a>                      <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">12</span>) </span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rdd_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="関数" class="level3">
<h3 class="anchored" data-anchor-id="関数">関数</h3>
<p>　パラメトリック推定、またはセミパラメトリック推定の場合、応答変数と強制変数間の関係をある関数として仮定する必要がある。セミパラメトリック推定は関数設定の影響力が比較的小さいが、バンド幅内のケース数が少なくなると、関数の形に影響を受けやすい。ここでは1次関数から4次関数までモデルを変えながら、推定値が安定しているかを確認してみよう。<code>rdrobust()</code>で関数の次数を指定するためには<code>p</code>引数を使用する。既定値は1であるが、<code>p</code>次関数を使う場合は<code>p</code>を指定する必要がある。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>rdd_p1 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">p =</span> <span class="dv">1</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>rdd_p2 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">p =</span> <span class="dv">2</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a>rdd_p3 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">p =</span> <span class="dv">3</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a>rdd_p4 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">p =</span> <span class="dv">4</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="fu">summary</span>(rdd_p1)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             318          381
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   8.064        8.064
BW bias (b)                  12.613       12.613
rho (h/b)                     0.639        0.639
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional     0.725     1.580     0.459     0.646    [-2.371 , 3.820]     
        Robust         -         -     0.528     0.598    [-2.692 , 4.677]     
=============================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">summary</span>(rdd_p2)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             358          433
Order est. (p)                    2            2
Order bias  (q)                   3            3
BW est. (h)                   9.205        9.205
BW bias (b)                  12.622       12.622
rho (h/b)                     0.729        0.729
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional     0.260     2.139     0.122     0.903    [-3.931 , 4.452]     
        Robust         -         -    -0.030     0.976    [-4.804 , 4.661]     
=============================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">summary</span>(rdd_p3)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             379          476
Order est. (p)                    3            3
Order bias  (q)                   4            4
BW est. (h)                  10.311       10.311
BW bias (b)                  13.458       13.458
rho (h/b)                     0.766        0.766
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional    -0.389     2.676    -0.145     0.884    [-5.633 , 4.855]     
        Robust         -         -    -0.240     0.811    [-6.462 , 5.055]     
=============================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">summary</span>(rdd_p4)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             420          567
Order est. (p)                    4            4
Order bias  (q)                   5            5
BW est. (h)                  12.653       12.653
BW bias (b)                  15.671       15.671
rho (h/b)                     0.807        0.807
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional    -0.472     3.002    -0.157     0.875    [-6.356 , 5.411]     
        Robust         -         -    -0.124     0.902    [-6.776 , 5.972]     
=============================================================================</code></pre>
</div>
</div>
<p>　以上の結果をまとめたものが以下である。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>order_compare <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Order =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb33-2"><a href="#cb33-2"></a>                        <span class="at">LATE  =</span> <span class="fu">c</span>(<span class="fl">0.725</span>, <span class="fl">0.260</span>, <span class="sc">-</span><span class="fl">0.389</span>, <span class="sc">-</span><span class="fl">0.472</span>),</span>
<span id="cb33-3"><a href="#cb33-3"></a>                        <span class="at">lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.371</span>, <span class="sc">-</span><span class="fl">3.931</span>, <span class="sc">-</span><span class="fl">5.633</span>, <span class="sc">-</span><span class="fl">6.356</span>),</span>
<span id="cb33-4"><a href="#cb33-4"></a>                        <span class="at">upper =</span> <span class="fu">c</span>(<span class="fl">3.820</span>, <span class="fl">4.452</span>, <span class="fl">4.855</span>, <span class="fl">5.411</span>))</span>
<span id="cb33-5"><a href="#cb33-5"></a></span>
<span id="cb33-6"><a href="#cb33-6"></a>order_compare</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  Order   LATE lower upper
  &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1  0.725 -2.37  3.82
2     2  0.26  -3.93  4.45
3     3 -0.389 -5.63  4.86
4     4 -0.472 -6.36  5.41</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>order_compare <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> Order, <span class="at">y =</span> LATE, </span>
<span id="cb35-5"><a href="#cb35-5"></a>                      <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Order of Local Polynomial Regression"</span>) <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">12</span>) </span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rdd_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>　結果は大きく変わらず、安定していることが分かる。</p>
</section>
</section>
<section id="可視化" class="level2">
<h2 class="anchored" data-anchor-id="可視化">可視化</h2>
<p>　{rdrobust}パッケージには可視化に便利な<code>rdplot()</code>関数が用意されている。使い方は<code>rdrobust()</code>とほぼ同じで、<code>y</code>には応答変数を、<code>x</code>には強制変数、<code>c</code>には閾値を指定すれば良い。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">rdplot</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rdd_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>　観測値が少ないように見えるが、これは強制変数を区間に分け、区間内の平均値を示したものである。通常のRDDはサンプルサイズが大きいため、散布図+回帰直線（曲線）だと線が見えなかったり、傾向が見にくくなる傾向がある。サンプルサイズが数百程度なら全観測値を見せても良いだろうが、今回は1200以上であり、このような見せ方が効果的である。</p>
<p>　1つ注意すべき点は、表示される回帰直線（曲線）の場合、2次関数が使用される。1次関数にフィットさせるためには、<code>rdrobust()</code>同様、<code>p = 1</code>を指定すれば良い。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">rdplot</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">p =</span> <span class="dv">1</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rdd_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>　また、この回帰直線の場合、カーネル関数は矩形関数である。三角形関数にするためには、更に<code>kernel = "triangular"</code>を指定する。また、<code>x.lab</code>、<code>y.lab</code>、<code>title</code>引数でラベルを修正することもできる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">rdplot</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">p =</span> <span class="dv">1</span>,</span>
<span id="cb38-2"><a href="#cb38-2"></a>       <span class="at">kernel =</span> <span class="st">"triangular"</span>,</span>
<span id="cb38-3"><a href="#cb38-3"></a>       <span class="at">x.label =</span> <span class="st">"Vote Margin in Election t"</span>,</span>
<span id="cb38-4"><a href="#cb38-4"></a>       <span class="at">y.label =</span> <span class="st">"Vote Share in Election t+1"</span>,</span>
<span id="cb38-5"><a href="#cb38-5"></a>       <span class="at">title =</span> <span class="st">""</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rdd_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>　以上の例は、バンド幅を設定せず、全観測値を利用したものである。<code>rdrobust()</code>のようにバンド幅を指定することはできないため、<code>subset</code>引数を使って使用するデータを制限することができる。たとえば、<code>rv</code>が-15より大きく、15より小さいケースのみを使う場合、<code>subset = (df$rv &gt; -15 &amp; df$rv &lt; 15)</code>と指定すれば良い。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">rdplot</span>(<span class="at">y =</span> df<span class="sc">$</span>outcome, <span class="at">x =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">p =</span> <span class="dv">1</span>,</span>
<span id="cb39-2"><a href="#cb39-2"></a>       <span class="at">kernel =</span> <span class="st">"triangular"</span>, </span>
<span id="cb39-3"><a href="#cb39-3"></a>       <span class="at">subset =</span> (df<span class="sc">$</span>rv <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">15</span> <span class="sc">&amp;</span> df<span class="sc">$</span>rv <span class="sc">&lt;</span> <span class="dv">15</span>),</span>
<span id="cb39-4"><a href="#cb39-4"></a>       <span class="at">x.label =</span> <span class="st">"Vote Margin in Election t"</span>,</span>
<span id="cb39-5"><a href="#cb39-5"></a>       <span class="at">y.label =</span> <span class="st">"Vote Share in Election t+1"</span>,</span>
<span id="cb39-6"><a href="#cb39-6"></a>       <span class="at">title =</span> <span class="st">""</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rdd_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="仮定の確認" class="level2">
<h2 class="anchored" data-anchor-id="仮定の確認">仮定の確認</h2>
<section id="交絡要因の連続性" class="level3">
<h3 class="anchored" data-anchor-id="交絡要因の連続性">交絡要因の連続性</h3>
<p>　RDDの重要な仮定の一つとして、交絡要因の連続性がある。交絡要因として考えられる要因が、処置群に割り当てられることでジャンプした場合、観察される処置効果がが処置によるものか、交絡要因のジャンブによるものかが識別できないからだ。今回の例では処置効果が見られていないが、それでもこの仮定は確認する価値がある。処置による効果（<span class="math inline">\(X \rightarrow Y\)</span>）と交絡要因による効果（<span class="math inline">\(Z \rightarrow Y\)</span>）が両方存在するケースを考えてみよう。もしこの2つの効果の符号が逆である場合、処置効果（<span class="math inline">\(X \rightarrow Y\)</span>）が交絡要因による効果（<span class="math inline">\(Z \rightarrow Y\)</span>）に相殺される可能性もあるからだ。</p>
<p>　確認する方法は簡単だ。もう一度RDDをするだけだ。ただし、応答変数が得票率（<code>outcome</code>）でなく、交絡要因に代わるだけだ。今回は候補者数（<code>total_cand</code>）、有効候補者数（<code>en_cand</code>）、得票数（<code>total_votes</code>）に対してRDDを行ってみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>assumption_fit1 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>total_cand, <span class="at">x =</span> df<span class="sc">$</span>rv)</span>
<span id="cb40-2"><a href="#cb40-2"></a>assumption_fit2 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>en_cand, <span class="at">x =</span> df<span class="sc">$</span>rv)</span>
<span id="cb40-3"><a href="#cb40-3"></a>assumption_fit3 <span class="ot">&lt;-</span> <span class="fu">rdrobust</span>(<span class="at">y =</span> df<span class="sc">$</span>total_votes, <span class="at">x =</span> df<span class="sc">$</span>rv)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">summary</span>(assumption_fit1)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             243          261
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   5.547        5.547
BW bias (b)                   8.621        8.621
rho (h/b)                     0.643        0.643
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional    -0.066     0.209    -0.315     0.753    [-0.475 , 0.344]     
        Robust         -         -    -0.415     0.678    [-0.593 , 0.385]     
=============================================================================</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">summary</span>(assumption_fit2)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             280          314
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   6.629        6.629
BW bias (b)                  10.114       10.114
rho (h/b)                     0.655        0.655
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional     0.032     0.111     0.289     0.772    [-0.186 , 0.251]     
        Robust         -         -     0.149     0.881    [-0.242 , 0.282]     
=============================================================================</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">summary</span>(assumption_fit3)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1266
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  479          787
Eff. Number of Obs.             291          341
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   7.131        7.131
BW bias (b)                  11.445       11.445
rho (h/b)                     0.623        0.623
Unique Obs.                     479          787

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional  1222.634  7020.544     0.174     0.862[-12537.380 , 14982.648] 
        Robust         -         -     0.042     0.967[-16145.541 , 16846.362] 
=============================================================================</code></pre>
</div>
</div>
<p>　いずれも統計的に有意なジャンプは見られない。以上の検定結果から「仮定は満たされている」ことは主張できないものの、「仮定が満たされていないとは言えない」までは主張できるはずだ。</p>
</section>
<section id="バランスチェック" class="level3">
<h3 class="anchored" data-anchor-id="バランスチェック">バランスチェック</h3>
<p>　ノンパラメトリックRDDの場合、バンド幅内であれば、処置群と統制群の性質はほぼ同じであると仮定する。つまり、処置変数を除く共変量が処置群と統制群の間において均質であることを意味する。それでは{BalanceR}を使って、候補者数（<code>total_cand</code>）、有効候補者数（<code>en_cand</code>）、得票数（<code>total_votes</code>）が処置群と統制群の間に差があるかを確認してみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>  <span class="co"># 処置の有無を示す treat 変数を作成</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">if_else</span>(rv <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="#cb47-4"></a>  <span class="fu">BalanceR</span>(<span class="at">group =</span> treat,</span>
<span id="cb47-5"><a href="#cb47-5"></a>           <span class="at">cov =</span> total_cand<span class="sc">:</span>total_votes) <span class="sc">|&gt;</span></span>
<span id="cb47-6"><a href="#cb47-6"></a>  <span class="fu">plot</span>(<span class="at">abs =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">"total_cand"</span> <span class="ot">=</span> <span class="st">"Total number of candidates"</span>,</span>
<span id="cb47-8"><a href="#cb47-8"></a>                             <span class="st">"en_cand"</span> <span class="ot">=</span> <span class="st">"Effective number of candidates"</span>,</span>
<span id="cb47-9"><a href="#cb47-9"></a>                             <span class="st">"total_votes"</span> <span class="ot">=</span> <span class="st">"Total votes"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rdd_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>　得票数（<code>total_votes</code>）の場合、標準化差分が非常に大きいことが分かる。それではバンド幅内のサンプルに限定すればどうだろうか。<code>filter()</code>を使って<code>rv</code>が-8.064より大きく、8.064より小さいサンプルに絞っってバランスチェックをしてみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">if_else</span>(rv <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="fu">filter</span>(rv <span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">8.064</span> <span class="sc">&amp;</span> rv <span class="sc">&lt;</span> <span class="fl">8.064</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="fu">BalanceR</span>(<span class="at">group =</span> treat,</span>
<span id="cb48-5"><a href="#cb48-5"></a>           <span class="at">cov =</span> total_cand<span class="sc">:</span>total_votes) <span class="sc">|&gt;</span></span>
<span id="cb48-6"><a href="#cb48-6"></a>  <span class="fu">plot</span>(<span class="at">abs =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">"total_cand"</span> <span class="ot">=</span> <span class="st">"Total number of candidates"</span>,</span>
<span id="cb48-8"><a href="#cb48-8"></a>                             <span class="st">"en_cand"</span> <span class="ot">=</span> <span class="st">"Effective number of candidates"</span>,</span>
<span id="cb48-9"><a href="#cb48-9"></a>                             <span class="st">"total_votes"</span> <span class="ot">=</span> <span class="st">"Total votes"</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rdd_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>　有効候補者数（<code>en_cand</code>）のバランスがむしろ悪くなったものの、他の2つの変数のバランスは改善されていることが分かる。</p>
</section>
<section id="強制変数の操作可能性" class="level3">
<h3 class="anchored" data-anchor-id="強制変数の操作可能性">強制変数の操作可能性</h3>
<p>　RDDのもう一つの重要な仮定として、閾値周辺において強制変数の操作が行われてはいけない。得票率の差を操作することは極めて困難なので、今回は問題はないと考えられるが、たとえばフランス地方議会選挙のように人口によって制度が変わる場合、特定の選挙制度を採用するために人口を操作することは不可能ではないだろう。</p>
<p>　この仮定を確認、検定する手法がMcCrayの密度検定 (density test)だ (McCray 2006)<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>。簡単に説明すると、強制変数の密度関数が閾値周辺においてジャンプしているか否かを確認する方法である。もし、操作が行われているとしたら、密度関数が断絶するだろう。</p>
<p>　密度検定は{rdd}の<code>DCdensity()</code>で簡単に行うことができる。第一引数は強制変数を、<code>cutpoint</code>には閾値を指定する（既定値は0であるため、今回は省略可能）。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">DCdensity</span>(df<span class="sc">$</span>rv, <span class="at">cutpoint =</span> <span class="dv">0</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rdd_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3002424</code></pre>
</div>
</div>
<p>　図と長さ1のnumeric型ベクトルが出力されるが<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>、図は密度分布を可視化したものであり、数値は「密度関数は連続している」という帰無仮説に対する<span class="math inline">\(p\)</span>値である。これが<span class="math inline">\(\alpha\)</span>（通常、<span class="math inline">\(\alpha = 0.05\)</span>）を下回る場合、帰無仮説は棄却され、密度関数が断絶していると判断できる。つまり、RDDの仮定を満たしていないことを意味する。</p>
<p>　{rdd}の<code>DCdensity()</code>以外にも、密度検定専用のパッケージ{rddenstiy}の<code>rddensity()</code>を使うことも可能だ。検定方法は基本的に同じだが、検定の際に使用するパラメーターや標準誤差計算のアルゴリズムが異なるため、結果はやや異なる。使い方は<code>X</code>に強制変数を、<code>c</code>に閾値を指定すれば良い。他にも十数種類のパラメーターが指定できるが詳細はコンソール上で<code>?rddensity</code>を入力し、ヘルプを参照すること。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>Density_Test <span class="ot">&lt;-</span> <span class="fu">rddensity</span>(<span class="at">X =</span> df<span class="sc">$</span>rv, <span class="at">c =</span> <span class="dv">0</span>)</span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="fu">summary</span>(Density_Test)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Manipulation testing using local polynomial density estimation.

Number of obs =       1266
Model =               unrestricted
Kernel =              triangular
BW method =           estimated
VCE method =          jackknife

c = 0                 Left of c           Right of c          
Number of obs         479                 787                 
Eff. Number of obs    259                 289                 
Order est. (p)        2                   2                   
Order bias (q)        3                   3                   
BW est. (h)           6.112               6.078               

Method                T                   P &gt; |T|             
Robust                -0.818              0.4134              


P-values of binomial tests (H0: p=0.5).

Window Length / 2          &lt;c     &gt;=c    P&gt;|T|
0.448                      20      24    0.6516
0.896                      41      41    1.0000
1.343                      65      59    0.6536
1.791                      89      79    0.4876
2.239                     108      98    0.5307
2.687                     129     116    0.4434
3.134                     151     135    0.3751
3.582                     168     163    0.8260
4.030                     188     185    0.9175
4.478                     200     204    0.8814</code></pre>
</div>
</div>
<p>　密度検定の結果（<span class="math inline">\(p\)</span>値）は中間辺りにある<code># Robust</code>行の0.4134だ。ここでも帰無仮説は棄却されず、強制変数の操作が行われているとは言えない。これらの結果を可視化の際は<code>rdplotdensity()</code>関数を使う。第一引数は<code>rddensity()</code>から得られたオブジェクト名を指定し、<code>X</code>には強制変数を指定する。その他の引数についてはヘルプ（コンソール上で<code>?rdplotdensity</code>）を参照すること。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>Density_Plot <span class="ot">&lt;-</span> <span class="fu">rdplotdensity</span>(Density_Test, <span class="at">X =</span> df<span class="sc">$</span>rv, </span>
<span id="cb53-2"><a href="#cb53-2"></a>                              <span class="at">type =</span> <span class="st">"both"</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">pwd =</span> <span class="dv">3</span>, <span class="at">pty =</span> <span class="dv">19</span>)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rdd_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>　また、要約結果の下段にあるBinomial testsは密度分布に代わるもう一つの検定手法だ。1行目はケースが20個入る範囲と、その中での処置群と統制群の大きさ、そしてその差の検定である。ここでは0.215だが、これは<code>rv</code>が-0.215から0.215の間に20個のケースがあるということを意味する。統制群は7ケース、処置群は13ケースである。もし、強制変数の操作が行われなかったのであれば、処置群の割合は0.5になるはずである。右の<code>P&gt;|T|</code>列は、<span class="math inline">\(p = 0.5\)</span>を帰無仮説とした二項検定における<span class="math inline">\(p\)</span>値である。もし、この値が<span class="math inline">\(\alpha\)</span>を下回ると、閾値周辺において何らかの操作が行われた可能性があることを示唆する。</p>
<p>　2行目は1行目の幅を2倍に、3行目は1行目の幅を3倍に、…したものである。いずれも<span class="math inline">\(p\)</span>値は0.05以上であり、強制変数の操作が行われたとは言えない。</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">脚注</h2>

<ol>
<li id="fn1"><p>もし、自分でバンド幅を指定したい場合、<code>bw = ...</code>の引数を加える。<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>閾値のデフォルトは0だ。もし、閾値が0ではない場合、<code>cutpoint = ...</code>の引数を設定する。<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2015b. “rdrobust: An R Package for Robust Nonparametric Inference in Regression-Discontinuity Designs,” <em>R Journal,</em> 7(1): 38-51.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><a href="https://doi.org/10.1016/j.jeconom.2007.05.005">McCray, Justin. 2008. “Manipulation of the running variable in the regression discontinuity design: A density test,” <em>Journal of Econometrics,</em> 142(2): 698-714.</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>図が不要なら<code>plot = FALSE</code>を指定する。<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "コピーしました");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "コピーしました");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.jaysong\.net\/kobe-ci\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../material/did.html" class="pagination-link" aria-label="差分の差分法">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">差分の差分法</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, <a href="https://www.jaysong.net" target="_blank">Jaehyun Song</a>. Powered by <a href="https://quarto.org/" target="_blank">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.jaysong.net">
      <i class="bi bi-house-fill" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/JaehyunSong">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>