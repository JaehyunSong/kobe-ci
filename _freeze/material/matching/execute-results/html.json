{
  "hash": "b42cd067a142e7e987844cc4e9f45040",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"マッチング\"\ntoc: true\nmetadata-files: \n  - _material.yml\n---\n\n\n\n\n## スライド\n\n<a href=\"../slide/matching.html\" class=\"btn btn-primary btn-sm\" target=\"_blank\" role=\"button\"><i class=\"bi bi-window\"></i> 新しいタブで開く</a>\n\n\n\n\n```{=html}\n<iframe class=\"slide-deck\" src=\"../slide/matching.html\" width=\"100%\" style=\"aspect-ratio: 16 / 9.2;\"></iframe>\n```\n\n\n\n\n## セットアップ\n\n　本日の実習で使用するパッケージを読み込む。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, \n               broom,\n               MatchIt, \n               WeightIt, \n               cobalt, \n               summarytools,\n               modelsummary,\n               fastDummies)\npacman::p_load_gh(\"JaehyunSong/BalanceR\")\n```\n:::\n\n\n\n\n　マッチングにおける古典的なデータセット、`lalonde`を読み込む。`data(lalonde, package = \"cobalt\")`を入力するだけで、{cobalt}パッケージ内の`laonde`という名前のデータフレームが作業環境内に`lalonde`という名で格納される[^cobalt-lalonde]。このデータを`la_df`という名のオブジェクトとして改めて保存しておこう。ただし、`lalonde`データセットの形式はdata.frameである。このままでも全く問題ないが、data.frameの拡張版であるtibble形式の方がより読みやすいので、格納する前に`lalonde`のデータ構造をdata.frameからtibbleへ変更しておこう（`as_tibble()`関数を使う）。\n\n[^cobalt-lalonde]: lalondeデータセットを提供するパッケージは複数あり、それぞれデータセットの構成に違いがある。どれを使っても実習には問題ないが、本資料の内容を再現される場合は`data()`内に`package = \"cobalt\"`を指定しよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# cobaltパッケージが提供するデータセットの読み込み\ndata(\"lalonde\", package = \"cobalt\")\n\nla_df <- as_tibble(lalonde)\n```\n:::\n\n\n\n\n　それでは、データの中身を確認してみよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nla_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 614 × 9\n   treat   age  educ race   married nodegree  re74  re75   re78\n   <int> <int> <int> <fct>    <int>    <int> <dbl> <dbl>  <dbl>\n 1     1    37    11 black        1        1     0     0  9930.\n 2     1    22     9 hispan       0        1     0     0  3596.\n 3     1    30    12 black        0        0     0     0 24909.\n 4     1    27    11 black        0        1     0     0  7506.\n 5     1    33     8 black        0        1     0     0   290.\n 6     1    22     9 black        0        1     0     0  4056.\n 7     1    23    12 black        0        0     0     0     0 \n 8     1    32    11 black        0        1     0     0  8472.\n 9     1    22    16 black        0        0     0     0  2164.\n10     1    33    12 white        1        0     0     0 12418.\n# ℹ 604 more rows\n```\n\n\n:::\n:::\n\n\n\n\n　分析に入る前に、名目変数である人種（`race`）をダミー変数に変換する。`race`は3種類の値で構成されているため、生成するダミー変数も3つとなる。ダミー化には{fastDummies}パッケージの`dummy_cols()`関数を使用する。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nla_df <- la_df |>\n  dummy_cols(select_columns = \"race\")\n\nla_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 614 × 12\n   treat   age  educ race   married nodegree  re74  re75   re78 race_black\n   <int> <int> <int> <fct>    <int>    <int> <dbl> <dbl>  <dbl>      <int>\n 1     1    37    11 black        1        1     0     0  9930.          1\n 2     1    22     9 hispan       0        1     0     0  3596.          0\n 3     1    30    12 black        0        0     0     0 24909.          1\n 4     1    27    11 black        0        1     0     0  7506.          1\n 5     1    33     8 black        0        1     0     0   290.          1\n 6     1    22     9 black        0        1     0     0  4056.          1\n 7     1    23    12 black        0        0     0     0     0           1\n 8     1    32    11 black        0        1     0     0  8472.          1\n 9     1    22    16 black        0        0     0     0  2164.          1\n10     1    33    12 white        1        0     0     0 12418.          0\n# ℹ 604 more rows\n# ℹ 2 more variables: race_hispan <int>, race_white <int>\n```\n\n\n:::\n:::\n\n\n\n\n　このまま記述統計を見たり、分析に入っても良いが、もう少しデータを加工してみよう。まず`race_`で始まる3つのダミー変数の位置を`race`の前へ変更する。また、`race`変数は不要なので、`race`変数を除外する。最後に、`race_`で始まるダミー変数の名前を変更してみよう。変数の位置変更は`relocate()`関数を使用する。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nla_df <- la_df |>\n  relocate(starts_with(\"race_\"), .before = race) |>\n  select(-race) |>\n  rename(\"black\"    = \"race_black\",\n         \"hispanic\" = \"race_hispan\",\n         \"white\"    = \"race_white\")\n\nla_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 614 × 11\n   treat   age  educ black hispanic white married nodegree  re74  re75   re78\n   <int> <int> <int> <int>    <int> <int>   <int>    <int> <dbl> <dbl>  <dbl>\n 1     1    37    11     1        0     0       1        1     0     0  9930.\n 2     1    22     9     0        1     0       0        1     0     0  3596.\n 3     1    30    12     1        0     0       0        0     0     0 24909.\n 4     1    27    11     1        0     0       0        1     0     0  7506.\n 5     1    33     8     1        0     0       0        1     0     0   290.\n 6     1    22     9     1        0     0       0        1     0     0  4056.\n 7     1    23    12     1        0     0       0        0     0     0     0 \n 8     1    32    11     1        0     0       0        1     0     0  8472.\n 9     1    22    16     1        0     0       0        0     0     0  2164.\n10     1    33    12     0        0     1       1        0     0     0 12418.\n# ℹ 604 more rows\n```\n\n\n:::\n:::\n\n\n\n\n　それでは記述統計量を確認してみよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndescr(la_df,\n      stats = c(\"mean\", \"sd\", \"min\", \"max\"),\n      transpose = TRUE,\n      order = \"p\")\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n|       &nbsp; |    Mean | Std.Dev |   Min |      Max |\n|-------------:|--------:|--------:|------:|---------:|\n|    **treat** |    0.30 |    0.46 |  0.00 |     1.00 |\n|      **age** |   27.36 |    9.88 | 16.00 |    55.00 |\n|     **educ** |   10.27 |    2.63 |  0.00 |    18.00 |\n|    **black** |    0.40 |    0.49 |  0.00 |     1.00 |\n| **hispanic** |    0.12 |    0.32 |  0.00 |     1.00 |\n|    **white** |    0.49 |    0.50 |  0.00 |     1.00 |\n|  **married** |    0.42 |    0.49 |  0.00 |     1.00 |\n| **nodegree** |    0.63 |    0.48 |  0.00 |     1.00 |\n|     **re74** | 4557.55 | 6477.96 |  0.00 | 35040.07 |\n|     **re75** | 2184.94 | 3295.68 |  0.00 | 25142.24 |\n|     **re78** | 6792.83 | 7470.73 |  0.00 | 60307.93 |\n:::\n\n\n\n\n## 回帰分析\n\n### DiM推定量\n\n　処置効果を確認するために、まずはグループごとの応答変数の差分（Difference-in-Means; DiM）を計算してみよう。処置変数は`treat`であり、職業訓練を受けた回答者は1、受けなかった回答者は0となる。応答変数`re78`は1978年における回答者の収入である。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nDiff_Mean_df <- la_df |> \n    group_by(treat) |>\n    summarise(Outcome = mean(re78),\n              .groups = \"drop\")\n\nDiff_Mean_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  treat Outcome\n  <int>   <dbl>\n1     0   6984.\n2     1   6349.\n```\n\n\n:::\n:::\n\n\n\n\n　この結果を可視化する必要はあまり無いかも知れないが、以下のようなコードで可視化することもできる。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nDiff_Mean_df |>\n  ggplot() +\n  geom_bar(aes(x = treat, y = Outcome), \n           stat = \"identity\", width = 0.5) +\n  geom_label(aes(x = treat, y = Outcome,\n                 label = round(Outcome, 3))) +\n  labs(x = \"Treatment\",\n       y = \"Outcome (US Dollars)\") +\n  # scale_x_continuous()を使って0/1をControl/Treatmentに置換する\n  # 目盛りはX軸上の0と1、各目盛りのラベルはControlとTreatmentに\n  scale_x_continuous(breaks = c(0, 1), labels = c(\"Control\", \"Treatment\")) +\n  coord_cartesian(xlim = c(-0.5, 1.5))\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=1050}\n:::\n:::\n\n\n\n\n　`treat == 0`の回答者、つまり職業訓練を受けていない回答者の平均所得は約6984ドル、`treat == 1`の回答者、つまり職業訓練を受けた回答者の平均所得は約6394ドルだ。その差は約-650ドルだが、職業訓練を受けた回答者の方が低所得になっている。これは直感的に納得できる結果ではないだろう。むろん、実際、職業訓練が所得を減らす可能性もあるが、今回の結果はより詳しく分析してみる価値があろう。\n\n　ちなみに、以上の結果は単回帰分析からも確認できる (ただし、統計的に有意ではない)。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nDiM_fit <- lm(re78 ~ treat, data = la_df)\nmodelsummary(DiM_fit,\n             # 係数の点推定値と95%信頼区間を示す場合\n             estimate   = \"{estimate} [{conf.low}, {conf.high}]\",\n             statistic  = NULL,\n             conf_level = 0.95,\n             # ケース数、決定係数、調整済み決定係数を出力\n             gof_map    = c(\"nobs\", \"r.squared\", \"adj.r.squared\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n      function styleCell_292rzfx1d9q0680v4s8t(i, j, css_id) {\n        var table = document.getElementById(\"tinytable_292rzfx1d9q0680v4s8t\");\n        table.rows[i].cells[j].classList.add(css_id);\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_292rzfx1d9q0680v4s8t');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_292rzfx1d9q0680v4s8t(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_292rzfx1d9q0680v4s8t\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(0, 0, 'tinytable_css_id0hkcix3pyt3lw0fd8ccf') })\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(0, 1, 'tinytable_css_idh1hxek7grulyyx329k76') })\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(1, 0, 'tinytable_css_idp8jr8nxgbe23nmg056z2') })\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(1, 1, 'tinytable_css_idbpt7duhjqwagskhws9gr') })\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(2, 0, 'tinytable_css_idrkwe27vf57vygk7fiqal') })\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(2, 1, 'tinytable_css_idnx2yy1nly1sxxufiq4p5') })\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(3, 0, 'tinytable_css_idp8jr8nxgbe23nmg056z2') })\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(3, 1, 'tinytable_css_idbpt7duhjqwagskhws9gr') })\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(4, 0, 'tinytable_css_idp8jr8nxgbe23nmg056z2') })\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(4, 1, 'tinytable_css_idbpt7duhjqwagskhws9gr') })\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(5, 0, 'tinytable_css_idp8jr8nxgbe23nmg056z2') })\nwindow.addEventListener('load', function () { styleCell_292rzfx1d9q0680v4s8t(5, 1, 'tinytable_css_idbpt7duhjqwagskhws9gr') })\n    </script>\n\n    <style>\n    .table td.tinytable_css_id0hkcix3pyt3lw0fd8ccf, .table th.tinytable_css_id0hkcix3pyt3lw0fd8ccf {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_idh1hxek7grulyyx329k76, .table th.tinytable_css_idh1hxek7grulyyx329k76 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_idp8jr8nxgbe23nmg056z2, .table th.tinytable_css_idp8jr8nxgbe23nmg056z2 {  text-align: left; }\n    .table td.tinytable_css_idbpt7duhjqwagskhws9gr, .table th.tinytable_css_idbpt7duhjqwagskhws9gr {  text-align: center; }\n    .table td.tinytable_css_idrkwe27vf57vygk7fiqal, .table th.tinytable_css_idrkwe27vf57vygk7fiqal {  border-bottom: solid 0.05em black;  text-align: left; }\n    .table td.tinytable_css_idnx2yy1nly1sxxufiq4p5, .table th.tinytable_css_idnx2yy1nly1sxxufiq4p5 {  border-bottom: solid 0.05em black;  text-align: center; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_292rzfx1d9q0680v4s8t\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">(1)</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>6984.170 [6275.791, 7692.549]</td>\n                </tr>\n                <tr>\n                  <td>treat      </td>\n                  <td>-635.026 [-1925.544, 655.492]</td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.   </td>\n                  <td>614                          </td>\n                </tr>\n                <tr>\n                  <td>R2         </td>\n                  <td>0.002                        </td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.    </td>\n                  <td>0.000                        </td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n\n　この直感的でない結果は、もしかしたらセレクションバイアスが原因かも知れない。職業訓練の対象が元々非常に所得が低い回答者になっている可能性がある。たとえば、下の図のように職業訓練の有無が教育水準や人種、これまでの所得などと関係しているとしよう。これらの要因は回答者の現在所得にも関係していると考えられる。この場合、処置有無と所得の間には内生性が存在することになる。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"作図用のコード\"}\npacman::p_load(ggdag)\ndagify(Income ~ Race + Training + Educ,\n       Training ~ Race + Educ,\n       exposure = \"Training\",\n       outcome  = \"Income\",\n       coords   = list(\n         x = c(Race = 1.5, Educ = 2.5, Training = 1, Income = 3),\n         y = c(Race = 2,   Educ = 2,   Training = 1, Income = 1)\n       )\n       ) |>\n  tidy_dagitty() |>\n  ggdag(confounder_triangle(), node_size = 20) +\n  coord_cartesian(xlim = c(0.8, 3.2), ylim = c(0.8, 2.2)) +\n  theme_dag_blank()\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=750}\n:::\n:::\n\n\n\n\n　本当にそうなのかを、共変量のバランスチェックをしてみよう。もし、処置有無によって回答者の社会経済的要因に大きな差があれば、内生性が存在する証拠になろう。ここでは[誰か](https://www.jaysong.net)が作成しました{BalanceR}パッケージを使ってみよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nblc_chk <- la_df |>\n  BalanceR(group = treat, cov = age:re75)\n```\n:::\n\n\n\n\n　{BalanceR}パッケージで共変量を指定する際、`:`演算子が使える。`age:re75`は、データセットの`age`から`re75`変数までをすべて指定することを意味する。`names(la_df)`で変数がどの順番で並んでいるかが分かる。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnames(la_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"treat\"    \"age\"      \"educ\"     \"black\"    \"hispanic\" \"white\"   \n [7] \"married\"  \"nodegree\" \"re74\"     \"re75\"     \"re78\"    \n```\n\n\n:::\n:::\n\n\n\n\n　それではバランスチェックの結果を確認してみよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nblc_chk\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Covariate   Mean:0     SD:0   Mean:1     SD:1   SB:0-1\n1       age   28.030   10.787   25.816    7.155   24.190\n2      educ   10.235    2.855   10.346    2.011   -4.476\n3     black    0.203    0.403    0.843    0.365 -167.083\n4  hispanic    0.142    0.350    0.059    0.237   27.740\n5     white    0.655    0.476    0.097    0.297  140.799\n6   married    0.513    0.500    0.189    0.393   72.076\n7  nodegree    0.597    0.491    0.708    0.456  -23.549\n8      re74 5619.237 6788.751 2095.574 4886.620   59.575\n9      re75 2466.484 3291.996 1532.055 3219.251   28.700\n```\n\n\n:::\n:::\n\n\n\n\n　アンバランスと判定する標準化差分（標準化バイアス）の閾値には決まった値が無いが、最も緩い基準でも25程度である（計算時に100を掛けないのであれば0.25）。しかし、いくつか怪しい箇所がある。たとえば、`treat == 0`の回答者において黒人の割合は約20%だが、`treat == 1`のそれは約85%だ。つまり、黒人ほどより職業訓練を受ける傾向があることを意味する。また、人種は所得にも影響を与えると考えられる。これは処置と応答変数の間に交絡要因があることを意味する。実際、標準化バイアスは-167という、非常に大きい数値を示している。この結果を図としてまとめてみましょう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# 絶対値変換。SB = 25に破線\nplot(blc_chk, abs = TRUE, vline = 25) +\n  # 縦軸目盛りラベルの修正\n  scale_y_discrete(labels = c(\"age\"      = \"Age\",\n                              \"educ\"     = \"Education\",\n                              \"black\"    = \"Race (Black)\",\n                              \"hispanic\" = \"Race (Hispanic)\",\n                              \"white\"    = \"Race (White)\",\n                              \"married\"  = \"Married\",\n                              \"nodegree\" = \"No Degree\",\n                              \"re74\"     = \"Revenue (1974)\",\n                              \"re75\"     = \"Revenue (1975)\")) +\n  # 凡例の削除\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-15-1.png){fig-align='center' width=1050}\n:::\n:::\n\n\n\n\n　かなり緩めの基準である25を採用しても、人種、結婚有無、74・75年の所得のバランスが非常に悪く、内生性（=自己選択バイアス）があると判断して良いだろう。以下ではこの内生性に対処する様々な方法を紹介する。\n\n### 重回帰分析\n\n　まずは、重回帰分析からだ。用いる共変量は年齢、教育水準、黒人ダミー、ヒスパニックダミー[^dummy]、既婚ダミー、学位なしダミー、74・75年の所得だ。`lm()`関数で78年の所得をこちらの変数に回帰させてみよう。\n\n[^dummy]: 人種のダミーは3つであるが、全てを投入する場合、多重共線性により、推定ができない（Rだと勝手に一つ落としてくれる）。必ず、一つは抜く必要があり、ここでは白人ダミー（`white`）を除外して。除外された変数をベースカテゴリ、参照カテゴリと呼ぶ。\n\n$$\n\\begin{align}\n\\widehat{\\mbox{re78}} = & \\beta_0 + \\beta_1 \\mbox{treat} + \\beta_2 \\mbox{age} + \\beta_3 \\mbox{educ} + \\\\\n& \\beta_4 \\mbox{black} + \\beta_5 \\mbox{hispanic} + \\beta_6 \\mbox{married} + \\beta_7 \\mbox{nodegree} + \\beta_8 \\mbox{re74} + \\beta_9 \\mbox{re75}.\n\\end{align}\n$$\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmlm_fit <- lm(re78 ~ treat + age + educ + black + hispanic + married + \n                   nodegree + re74 + re75, data = la_df)\n\nmodelsummary(list(\"単回帰分析\" = DiM_fit, \"重回帰分析\" = mlm_fit), \n             estimate  = \"{estimate} ({std.error})\",\n             statistic = NULL,\n             gof_map   = c(\"nobs\", \"r.squared\", \"adj.r.squared\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n      function styleCell_bq2uh2r5th0rpcklxh01(i, j, css_id) {\n        var table = document.getElementById(\"tinytable_bq2uh2r5th0rpcklxh01\");\n        table.rows[i].cells[j].classList.add(css_id);\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_bq2uh2r5th0rpcklxh01');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_bq2uh2r5th0rpcklxh01(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_bq2uh2r5th0rpcklxh01\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(0, 0, 'tinytable_css_idvmem74uv2sf4pon5iknl') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(0, 1, 'tinytable_css_ida5unfuh0lyxyu08z26ei') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(0, 2, 'tinytable_css_ida5unfuh0lyxyu08z26ei') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(1, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(1, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(1, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(2, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(2, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(2, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(3, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(3, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(3, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(4, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(4, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(4, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(5, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(5, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(5, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(6, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(6, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(6, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(7, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(7, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(7, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(8, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(8, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(8, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(9, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(9, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(9, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(10, 0, 'tinytable_css_idggm8vb1h5uh21n8ua26d') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(10, 1, 'tinytable_css_id9vrilwuegaa1fjorxebx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(10, 2, 'tinytable_css_id9vrilwuegaa1fjorxebx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(11, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(11, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(11, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(12, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(12, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(12, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(13, 0, 'tinytable_css_idwdcod68h2fxcjcpoaplx') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(13, 1, 'tinytable_css_idsegggs5jasvedb49v1qb') })\nwindow.addEventListener('load', function () { styleCell_bq2uh2r5th0rpcklxh01(13, 2, 'tinytable_css_idsegggs5jasvedb49v1qb') })\n    </script>\n\n    <style>\n    .table td.tinytable_css_idvmem74uv2sf4pon5iknl, .table th.tinytable_css_idvmem74uv2sf4pon5iknl {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_ida5unfuh0lyxyu08z26ei, .table th.tinytable_css_ida5unfuh0lyxyu08z26ei {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_idwdcod68h2fxcjcpoaplx, .table th.tinytable_css_idwdcod68h2fxcjcpoaplx {  text-align: left; }\n    .table td.tinytable_css_idsegggs5jasvedb49v1qb, .table th.tinytable_css_idsegggs5jasvedb49v1qb {  text-align: center; }\n    .table td.tinytable_css_idggm8vb1h5uh21n8ua26d, .table th.tinytable_css_idggm8vb1h5uh21n8ua26d {  border-bottom: solid 0.05em black;  text-align: left; }\n    .table td.tinytable_css_id9vrilwuegaa1fjorxebx, .table th.tinytable_css_id9vrilwuegaa1fjorxebx {  border-bottom: solid 0.05em black;  text-align: center; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_bq2uh2r5th0rpcklxh01\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">単回帰分析</th>\n                <th scope=\"col\">重回帰分析</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>6984.170 (360.710)</td>\n                  <td>66.515 (2436.746)  </td>\n                </tr>\n                <tr>\n                  <td>treat      </td>\n                  <td>-635.026 (657.137)</td>\n                  <td>1548.244 (781.279) </td>\n                </tr>\n                <tr>\n                  <td>age        </td>\n                  <td>                  </td>\n                  <td>12.978 (32.489)    </td>\n                </tr>\n                <tr>\n                  <td>educ       </td>\n                  <td>                  </td>\n                  <td>403.941 (158.906)  </td>\n                </tr>\n                <tr>\n                  <td>black      </td>\n                  <td>                  </td>\n                  <td>-1240.644 (768.764)</td>\n                </tr>\n                <tr>\n                  <td>hispanic   </td>\n                  <td>                  </td>\n                  <td>498.897 (941.943)  </td>\n                </tr>\n                <tr>\n                  <td>married    </td>\n                  <td>                  </td>\n                  <td>406.621 (695.472)  </td>\n                </tr>\n                <tr>\n                  <td>nodegree   </td>\n                  <td>                  </td>\n                  <td>259.817 (847.442)  </td>\n                </tr>\n                <tr>\n                  <td>re74       </td>\n                  <td>                  </td>\n                  <td>0.296 (0.058)      </td>\n                </tr>\n                <tr>\n                  <td>re75       </td>\n                  <td>                  </td>\n                  <td>0.232 (0.105)      </td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.   </td>\n                  <td>614               </td>\n                  <td>614                </td>\n                </tr>\n                <tr>\n                  <td>R2         </td>\n                  <td>0.002             </td>\n                  <td>0.148              </td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.    </td>\n                  <td>0.000             </td>\n                  <td>0.135              </td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n\n　共変量を統制したら処置変数の係数は約1548.244ドルだ。単回帰分析の結果とは違って、統計的に有意な正の効果が確認されている。ますます分からなくなってしまう。\n\n## マッチング\n\n### 最近傍マッチング\n\n　重回帰分析は非常にシンプルで便利な分析方法ですが、いくつかの欠点がある。まず、重回帰分析は変数間の関係（線形結合）および誤差項の分布（平均0の正規分布）などを仮定したパラメトリック分析ということだ。この場合、同じ共変量を持たないケースであっても、勝手に予測を行うこととなる。重回帰分析における処置変数の解釈は「他の共変量がすべて同じ」場合の処置効果である。これは、共変量がすべて同じ場合における（最初に見た）単純差分のようなものである。しかし、「他の共変量がすべて同じ」ケースが存在しない可能性があろう。特に、共変量が多く、連続変数の場合、共変量がすべて同じことは実質あり得ないか、非常に少ないケースに限定されることもある。一方、マッチングを行うと、「他の共変量がすべて同じ」、または「非常に似ている」ケース間で比較を行うことになる。\n\n　本資料では以下の3つのマッチング手法の実装方法について解説する。\n\n1. 最近傍マッチング（マハラノビス距離）\n2. 最近傍マッチング（傾向スコア）\n3. Coarsened Exact Matching (CEM)\n\n　まずは、マハラノビス距離を用いた最近傍マッチングから始めよう。だいたいのマッチング手法は{MatchIt}パッケージで解決できる。マッチングデータセットを作成する関数は`matchit()`関数であり、使い方は以下の通りである。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmatchit(処置変数 ~ 共変量1 + ... + 共変量k, \n            data = データフレーム名, estimand = \"ATT\",\n            method = \"nearest\", distance = \"mahalanobis\")\n```\n:::\n\n\n\n\n　`method = \"nearest\"`は最近傍マッチングを、`distance = \"mahalanobis\"`はマハラノビス距離を意味する。`estimand = \"ATT\"`はAT**T**を推定することを意味する。{MatchIt}の最近傍マッチングの場合、`\"ATT\"`、または`\"ATC\"`のみ指定可能である（後で紹介するCEMでは`\"ATE\"`も指定可能）。早速やってみよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmh_mat1 <- matchit(treat ~ age + educ + black + hispanic + married + \n                     nodegree + re74 + re75, \n                   data = la_df, estimand = \"ATT\",\n                   method = \"nearest\", distance = \"mahalanobis\")\n```\n:::\n\n\n\n\n　マッチング後のデータでバランスが取れているかを確認するためにはいくつかの方法があるが、ここでは{cobalt}パッケージを使って、標準化差分を確認してみよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlove.plot(mh_mat1, thresholds = 0.25, abs = TRUE)\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-19-1.png){fig-align='center' width=1050}\n:::\n:::\n\n\n\n\n　`thresholds`引数は垂直線（破線）の位置、`abs`は標準化差分を絶対値で示すことを意味する。マッチング後の標準化差分（Adjusted; 赤い点）が0.25より左側に位置している場合、バランスしていると判断できる[^SB25]。むろん、より厳格な基準として0.03、0.05、0.1を使うこともできる。他にもマッチング後の標準化差分がマッチング前（Unadjusted; 青い点）より改善されるいるか否かも判断できる。今回の例だと、大幅にバランスが改善されている。0.25を基準とした場合、`black`はまだバランスが取れていないが、それでも大幅に改善されていることが分かる。\n\n[^SB25]: ここでは基準としている標準化差分0.25は{BalanceR}の25と同じである。\n\n　それではAT**T**を推定してみよう。推定方法としてはノンパラメトリックな方法とパラメトリック方法があるが、結果は変わらない。ノンパラメトリックな方法はペアごとの差分を計算し、その平均値を求める方法だが、マッチング済みのデータに対し、処置変数を結果変数を回帰させることも、結果的には同じことを行うことになる。したがって、もっと簡単なパラメトリック方法、つまり単回帰分析でAT**T**を推定しよう。\n\n　回帰分析を行うためにはデータが必要だ。つまり、マッチングされないケースをデータから除去する必要がある。ここでは`match.data()`関数を使ったマッチングされたケースのみを抽出してみよう。抽出したデータは`mh_data1`と名付ける。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmh_data1 <- match.data(mh_mat1)\n```\n:::\n\n\n\n\nマッチングデータが取れたら、その中身を確認してみましょう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmh_data1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 370 × 13\n   treat   age  educ black hispanic white married nodegree  re74  re75   re78\n   <int> <int> <int> <int>    <int> <int>   <int>    <int> <dbl> <dbl>  <dbl>\n 1     1    37    11     1        0     0       1        1     0     0  9930.\n 2     1    22     9     0        1     0       0        1     0     0  3596.\n 3     1    30    12     1        0     0       0        0     0     0 24909.\n 4     1    27    11     1        0     0       0        1     0     0  7506.\n 5     1    33     8     1        0     0       0        1     0     0   290.\n 6     1    22     9     1        0     0       0        1     0     0  4056.\n 7     1    23    12     1        0     0       0        0     0     0     0 \n 8     1    32    11     1        0     0       0        1     0     0  8472.\n 9     1    22    16     1        0     0       0        0     0     0  2164.\n10     1    33    12     0        0     1       1        0     0     0 12418.\n# ℹ 360 more rows\n# ℹ 2 more variables: weights <dbl>, subclass <fct>\n```\n\n\n:::\n:::\n\n\n\n\n　データのサイズは370行14列であり、この370行には意味がある。それは処置群の大きさの2倍という点だ。多くの場合、マッチングから計算される処置効果はATEではなく、ATTである。したがって、処置群のデータを100%活用し、共変量（のマハラノビス距離）が最も近いケースを統制群から抽出&マッチングすることになる。だから、マッチング後のサンプルサイズは処置群のサイズの2倍になる。\n\n　それでは職業訓練のAT**T**を推定してみよう。方法は簡単だ。マッチング後のデータ（`mh_data1`）を用い、単回帰分析を行うだけである。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmh_fit1 <- lm(re78 ~ treat, data = mh_data1)\n\nmodelsummary(mh_fit1)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n      function styleCell_hgj8452nzd61evwa8i41(i, j, css_id) {\n        var table = document.getElementById(\"tinytable_hgj8452nzd61evwa8i41\");\n        table.rows[i].cells[j].classList.add(css_id);\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_hgj8452nzd61evwa8i41');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_hgj8452nzd61evwa8i41(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_hgj8452nzd61evwa8i41\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(0, 0, 'tinytable_css_id4quzfkolgftctzushpxs') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(0, 1, 'tinytable_css_id32c1i85av08inhjiygt6') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(1, 0, 'tinytable_css_idlhcpe3eg72pckyfc17ov') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(1, 1, 'tinytable_css_idg3n1m9moc7oum1sglpah') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(2, 0, 'tinytable_css_idlhcpe3eg72pckyfc17ov') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(2, 1, 'tinytable_css_idg3n1m9moc7oum1sglpah') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(3, 0, 'tinytable_css_idlhcpe3eg72pckyfc17ov') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(3, 1, 'tinytable_css_idg3n1m9moc7oum1sglpah') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(4, 0, 'tinytable_css_id9ostcg2i8wjswf49dvx9') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(4, 1, 'tinytable_css_id6bal6zgcbv7pe3yfqt12') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(5, 0, 'tinytable_css_idlhcpe3eg72pckyfc17ov') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(5, 1, 'tinytable_css_idg3n1m9moc7oum1sglpah') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(6, 0, 'tinytable_css_idlhcpe3eg72pckyfc17ov') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(6, 1, 'tinytable_css_idg3n1m9moc7oum1sglpah') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(7, 0, 'tinytable_css_idlhcpe3eg72pckyfc17ov') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(7, 1, 'tinytable_css_idg3n1m9moc7oum1sglpah') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(8, 0, 'tinytable_css_idlhcpe3eg72pckyfc17ov') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(8, 1, 'tinytable_css_idg3n1m9moc7oum1sglpah') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(9, 0, 'tinytable_css_idlhcpe3eg72pckyfc17ov') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(9, 1, 'tinytable_css_idg3n1m9moc7oum1sglpah') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(10, 0, 'tinytable_css_idlhcpe3eg72pckyfc17ov') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(10, 1, 'tinytable_css_idg3n1m9moc7oum1sglpah') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(11, 0, 'tinytable_css_idlhcpe3eg72pckyfc17ov') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(11, 1, 'tinytable_css_idg3n1m9moc7oum1sglpah') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(12, 0, 'tinytable_css_idlhcpe3eg72pckyfc17ov') })\nwindow.addEventListener('load', function () { styleCell_hgj8452nzd61evwa8i41(12, 1, 'tinytable_css_idg3n1m9moc7oum1sglpah') })\n    </script>\n\n    <style>\n    .table td.tinytable_css_id4quzfkolgftctzushpxs, .table th.tinytable_css_id4quzfkolgftctzushpxs {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_id32c1i85av08inhjiygt6, .table th.tinytable_css_id32c1i85av08inhjiygt6 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_idlhcpe3eg72pckyfc17ov, .table th.tinytable_css_idlhcpe3eg72pckyfc17ov {  text-align: left; }\n    .table td.tinytable_css_idg3n1m9moc7oum1sglpah, .table th.tinytable_css_idg3n1m9moc7oum1sglpah {  text-align: center; }\n    .table td.tinytable_css_id9ostcg2i8wjswf49dvx9, .table th.tinytable_css_id9ostcg2i8wjswf49dvx9 {  border-bottom: solid 0.05em black;  text-align: left; }\n    .table td.tinytable_css_id6bal6zgcbv7pe3yfqt12, .table th.tinytable_css_id6bal6zgcbv7pe3yfqt12 {  border-bottom: solid 0.05em black;  text-align: center; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_hgj8452nzd61evwa8i41\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">(1)</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>5832.507 </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(527.987)</td>\n                </tr>\n                <tr>\n                  <td>treat      </td>\n                  <td>516.637  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(746.686)</td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.   </td>\n                  <td>370      </td>\n                </tr>\n                <tr>\n                  <td>R2         </td>\n                  <td>0.001    </td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.    </td>\n                  <td>-0.001   </td>\n                </tr>\n                <tr>\n                  <td>AIC        </td>\n                  <td>7624.7   </td>\n                </tr>\n                <tr>\n                  <td>BIC        </td>\n                  <td>7636.4   </td>\n                </tr>\n                <tr>\n                  <td>Log.Lik.   </td>\n                  <td>-3809.327</td>\n                </tr>\n                <tr>\n                  <td>F          </td>\n                  <td>0.479    </td>\n                </tr>\n                <tr>\n                  <td>RMSE       </td>\n                  <td>7161.96  </td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n\n```{.r .cell-code}\nmodelsummary(list(\"単回帰・非復元\" = mh_fit1), \n             estimate  = \"{estimate} ({std.error})\",\n             statistic = NULL,\n             gof_map   = c(\"nobs\", \"r.squared\", \"adj.r.squared\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n      function styleCell_wcyq0dqdmq9y9d95vcmf(i, j, css_id) {\n        var table = document.getElementById(\"tinytable_wcyq0dqdmq9y9d95vcmf\");\n        table.rows[i].cells[j].classList.add(css_id);\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_wcyq0dqdmq9y9d95vcmf');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_wcyq0dqdmq9y9d95vcmf(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_wcyq0dqdmq9y9d95vcmf\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(0, 0, 'tinytable_css_idtfauvyj5xzvilcbyhkfe') })\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(0, 1, 'tinytable_css_idkx6sqb9g2jcpxafskgpm') })\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(1, 0, 'tinytable_css_idklhw6p4furr0wzqkgvsp') })\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(1, 1, 'tinytable_css_idvwrxj2nyfm25fed8kmty') })\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(2, 0, 'tinytable_css_id8d5uyd69tn4oqu3bdxjr') })\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(2, 1, 'tinytable_css_id5rwk7x7nhqgniiyn5hrn') })\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(3, 0, 'tinytable_css_idklhw6p4furr0wzqkgvsp') })\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(3, 1, 'tinytable_css_idvwrxj2nyfm25fed8kmty') })\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(4, 0, 'tinytable_css_idklhw6p4furr0wzqkgvsp') })\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(4, 1, 'tinytable_css_idvwrxj2nyfm25fed8kmty') })\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(5, 0, 'tinytable_css_idklhw6p4furr0wzqkgvsp') })\nwindow.addEventListener('load', function () { styleCell_wcyq0dqdmq9y9d95vcmf(5, 1, 'tinytable_css_idvwrxj2nyfm25fed8kmty') })\n    </script>\n\n    <style>\n    .table td.tinytable_css_idtfauvyj5xzvilcbyhkfe, .table th.tinytable_css_idtfauvyj5xzvilcbyhkfe {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_idkx6sqb9g2jcpxafskgpm, .table th.tinytable_css_idkx6sqb9g2jcpxafskgpm {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_idklhw6p4furr0wzqkgvsp, .table th.tinytable_css_idklhw6p4furr0wzqkgvsp {  text-align: left; }\n    .table td.tinytable_css_idvwrxj2nyfm25fed8kmty, .table th.tinytable_css_idvwrxj2nyfm25fed8kmty {  text-align: center; }\n    .table td.tinytable_css_id8d5uyd69tn4oqu3bdxjr, .table th.tinytable_css_id8d5uyd69tn4oqu3bdxjr {  border-bottom: solid 0.05em black;  text-align: left; }\n    .table td.tinytable_css_id5rwk7x7nhqgniiyn5hrn, .table th.tinytable_css_id5rwk7x7nhqgniiyn5hrn {  border-bottom: solid 0.05em black;  text-align: center; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_wcyq0dqdmq9y9d95vcmf\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">単回帰・非復元</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>5832.507 (527.987)</td>\n                </tr>\n                <tr>\n                  <td>treat      </td>\n                  <td>516.637 (746.686) </td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.   </td>\n                  <td>370               </td>\n                </tr>\n                <tr>\n                  <td>R2         </td>\n                  <td>0.001             </td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.    </td>\n                  <td>-0.001            </td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n\n　処置効果は約516.637ドルである。今回の結果は重回帰分析よりも推定値が低めであり、統計的に有意に職業訓練の効果があったとは言えないという結果が得られましたね。また、マッチング後のデータを使って**重**回帰分析を行うこともできる。マッチング後のデータを見ると、黒人ダミーのバランスは大幅に改善されたが、それでもまだアンバランスしていると言える。他にも、74・75年の所得や年齢もそれなりに標準化差分が大きい。このような場合、もう一度共変量を投入して分析を行うこともできる。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmh_fit2 <- lm(re78 ~ treat + age + educ + black + hispanic + married + \n                   nodegree + re74 + re75, data = mh_data1)\n\nmodelsummary(list(\"単回帰・非復元\" = mh_fit1,\n                  \"重回帰・非復元\" = mh_fit2), \n             gof_map   = c(\"nobs\", \"r.squared\", \"adj.r.squared\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n      function styleCell_yt8varc4kkdqrgvmibwj(i, j, css_id) {\n        var table = document.getElementById(\"tinytable_yt8varc4kkdqrgvmibwj\");\n        table.rows[i].cells[j].classList.add(css_id);\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_yt8varc4kkdqrgvmibwj');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_yt8varc4kkdqrgvmibwj(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_yt8varc4kkdqrgvmibwj\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(0, 0, 'tinytable_css_idq6o26g4vzw2o0yyfv0ib') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(0, 1, 'tinytable_css_idjexs5081pc8y9xox3mrm') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(0, 2, 'tinytable_css_idjexs5081pc8y9xox3mrm') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(1, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(1, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(1, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(2, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(2, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(2, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(3, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(3, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(3, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(4, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(4, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(4, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(5, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(5, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(5, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(6, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(6, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(6, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(7, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(7, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(7, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(8, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(8, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(8, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(9, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(9, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(9, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(10, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(10, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(10, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(11, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(11, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(11, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(12, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(12, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(12, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(13, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(13, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(13, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(14, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(14, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(14, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(15, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(15, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(15, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(16, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(16, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(16, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(17, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(17, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(17, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(18, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(18, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(18, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(19, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(19, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(19, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(20, 0, 'tinytable_css_id9pq4n4foltsdfnaifi11') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(20, 1, 'tinytable_css_idbym1sbtfp9wycxemvf8q') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(20, 2, 'tinytable_css_idbym1sbtfp9wycxemvf8q') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(21, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(21, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(21, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(22, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(22, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(22, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(23, 0, 'tinytable_css_ids7tc8ohmr0d5wvnsmkmg') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(23, 1, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\nwindow.addEventListener('load', function () { styleCell_yt8varc4kkdqrgvmibwj(23, 2, 'tinytable_css_id0bw3zik47wxwx9p6ze9s') })\n    </script>\n\n    <style>\n    .table td.tinytable_css_idq6o26g4vzw2o0yyfv0ib, .table th.tinytable_css_idq6o26g4vzw2o0yyfv0ib {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_idjexs5081pc8y9xox3mrm, .table th.tinytable_css_idjexs5081pc8y9xox3mrm {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_ids7tc8ohmr0d5wvnsmkmg, .table th.tinytable_css_ids7tc8ohmr0d5wvnsmkmg {  text-align: left; }\n    .table td.tinytable_css_id0bw3zik47wxwx9p6ze9s, .table th.tinytable_css_id0bw3zik47wxwx9p6ze9s {  text-align: center; }\n    .table td.tinytable_css_id9pq4n4foltsdfnaifi11, .table th.tinytable_css_id9pq4n4foltsdfnaifi11 {  border-bottom: solid 0.05em black;  text-align: left; }\n    .table td.tinytable_css_idbym1sbtfp9wycxemvf8q, .table th.tinytable_css_idbym1sbtfp9wycxemvf8q {  border-bottom: solid 0.05em black;  text-align: center; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_yt8varc4kkdqrgvmibwj\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">単回帰・非復元</th>\n                <th scope=\"col\">重回帰・非復元</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>5832.507 </td>\n                  <td>-453.365  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(527.987)</td>\n                  <td>(3546.028)</td>\n                </tr>\n                <tr>\n                  <td>treat      </td>\n                  <td>516.637  </td>\n                  <td>1239.696  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(746.686)</td>\n                  <td>(812.039) </td>\n                </tr>\n                <tr>\n                  <td>age        </td>\n                  <td>         </td>\n                  <td>15.112    </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(45.720)  </td>\n                </tr>\n                <tr>\n                  <td>educ       </td>\n                  <td>         </td>\n                  <td>533.042   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(243.621) </td>\n                </tr>\n                <tr>\n                  <td>black      </td>\n                  <td>         </td>\n                  <td>-1158.148 </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(906.948) </td>\n                </tr>\n                <tr>\n                  <td>hispanic   </td>\n                  <td>         </td>\n                  <td>1120.562  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(1676.953)</td>\n                </tr>\n                <tr>\n                  <td>married    </td>\n                  <td>         </td>\n                  <td>653.748   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(984.773) </td>\n                </tr>\n                <tr>\n                  <td>nodegree   </td>\n                  <td>         </td>\n                  <td>-170.705  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(1116.240)</td>\n                </tr>\n                <tr>\n                  <td>re74       </td>\n                  <td>         </td>\n                  <td>0.071     </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(0.098)   </td>\n                </tr>\n                <tr>\n                  <td>re75       </td>\n                  <td>         </td>\n                  <td>0.272     </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(0.155)   </td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.   </td>\n                  <td>370      </td>\n                  <td>370       </td>\n                </tr>\n                <tr>\n                  <td>R2         </td>\n                  <td>0.001    </td>\n                  <td>0.076     </td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.    </td>\n                  <td>-0.001   </td>\n                  <td>0.053     </td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n\n　ちなみに、{MatchIt}パッケージを使った最近傍マッチングのの結果は行う度に変化することがある。{MatchIt}パッケージを使った最近傍マッチングの場合、処置群 (統制群)から一つのケースを選択し、最も近い統制群 (処置群)とマッチングする。マッチングされたケースは次のステップからはマッチング対象から除外されることになる[^replace]。また、1:1マッチングの場合[^ratio]、同距離に複数のマッチング対象があると、ランダムに1つのみを選択する。最近傍マッチングを用いる際は、複数推定を行い、推定が安定するかを確認し、不安定な場合は他の手法を使うか、k-最近傍マッチングなどを使ってみよう。\n\n[^replace]: これは`matchit()`内に`replacement = TRUE`を指定することで防ぐことができる。既定値は`FALSE`だが、`TRUE`を指定すれば、マッチングされた統制群ケースを2回以上マッチングすることができる。どちらが正しいということはないが、非復元（`FALSE`）が一般的だという意見もある（Lanza et al. 2013）。\n\n[^ratio]: これは`matchit()`内に`ratio`引数を指定することで防ぐことができる。既定値は1であり、この場合は1:1マッチングを意味する。\n\n　ここでは復元マッチングの例を紹介しよう。やり方は`matchit()`内に`replace = TRUE`を追加するだけだ。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmh_mat2 <- matchit(treat ~ age + educ + black + hispanic + married + \n                     nodegree + re74 + re75, \n                   data = la_df, estimand = \"ATT\", replace = TRUE,\n                   method = \"nearest\", distance = \"mahalanobis\")\nmh_data2 <- match.data(mh_mat2)\n```\n:::\n\n\n\n\n　マッチング後のデータを確認する前に、バランスチェックをしてみよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlove.plot(mh_mat2, thresholds = 0.25, abs = TRUE)\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-25-1.png){fig-align='center' width=1050}\n:::\n:::\n\n\n\n\n　復元マッチングのメリットは非復元マッチングに比べ、バランス改善の程度が大きいという点だ。非復元マッチングの場合、マッチングに使われた統制群は二度と使われないため、場合によっては近いマッチングケースがあるにも関わらず、マッチングできないからだ。ただし、復元マッチングにもデメリットはある。たとえば、有効サンプルサイズ（Effective Sample Size; ESS）が小さくなり、精度が悪くなる点、場合によっては特殊な標準誤差[^replace-se]を使う必要があるといった欠点もある。\n\n[^replace-se]: [Austin, Peter C., and Guy Cafri. 2020. \"Variance Estimation When Using Propensity-Score Matching with Replacement with Survival or Time-to-Event Outcomes.\" *Statistics in Medicine,* 39 (11): 1623–40.](https://doi.org/10.1002/sim.8502)\n\n　それではマッチング後のデータを確認してみよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmh_data2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 260 × 12\n   treat   age  educ black hispanic white married nodegree  re74  re75   re78\n   <int> <int> <int> <int>    <int> <int>   <int>    <int> <dbl> <dbl>  <dbl>\n 1     1    37    11     1        0     0       1        1     0     0  9930.\n 2     1    22     9     0        1     0       0        1     0     0  3596.\n 3     1    30    12     1        0     0       0        0     0     0 24909.\n 4     1    27    11     1        0     0       0        1     0     0  7506.\n 5     1    33     8     1        0     0       0        1     0     0   290.\n 6     1    22     9     1        0     0       0        1     0     0  4056.\n 7     1    23    12     1        0     0       0        0     0     0     0 \n 8     1    32    11     1        0     0       0        1     0     0  8472.\n 9     1    22    16     1        0     0       0        0     0     0  2164.\n10     1    33    12     0        0     1       1        0     0     0 12418.\n# ℹ 250 more rows\n# ℹ 1 more variable: weights <dbl>\n```\n\n\n:::\n:::\n\n\n\n\n　今回は370行ではないことが分かる。なぜなら統制群のケースが複数マッチングされることもあるからだ。処置群は100%使われるので、マッチングに使われた統制群のケースは260-185=75ケースである。この特徴により推定の際は一点、注意が必要である。推定のやり方自体はほぼ同じである。しかし、**非**復元マッチングの場合、統制群からマッチングされたケースは1回のみ使われるため、一つ一つのケースの重みは同じである。`match.data()`から得られーたデータには`weights`列が含まれており、`mh_data1`の`weights`列を見ると全ての重みが1だということが分かる。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmh_data1$weights\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n 21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n 41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n 61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n 81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n181 182 183 184 185 186 190 191 192 193 195 200 202 203 205 208 209 212 226 228 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n231 233 244 254 257 271 273 274 275 276 278 279 280 281 282 283 284 285 288 290 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n295 296 297 303 306 312 319 322 323 325 327 335 339 342 343 344 352 353 356 358 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n362 363 364 365 367 368 369 370 372 374 376 378 381 384 387 390 393 394 398 399 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n402 403 405 409 411 413 414 415 416 419 420 422 423 427 430 432 436 438 441 443 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n445 446 450 451 453 454 455 457 458 459 462 463 465 466 467 470 474 475 476 478 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n485 493 499 500 501 507 508 510 511 512 515 516 518 520 522 524 525 526 527 530 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n536 537 538 539 540 541 542 544 546 551 552 553 555 556 557 558 559 560 561 562 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n563 565 566 567 571 572 573 574 576 577 578 580 581 582 583 584 585 586 591 592 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n593 594 596 597 601 604 607 608 610 613 \n  1   1   1   1   1   1   1   1   1   1 \n```\n\n\n:::\n:::\n\n\n\n\n　一方、復元マッチングの場合、一つのケースが複数回マッチングされる場合もある。たとえば、191番目のケースは統制群であるが、重みが1.2162162だ。この意味は191番目のケースは計3回（$1.2162162\\times\\frac{185}{75}$）マッチングに使われたことを意味する。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmh_data2$weights\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1         2         3         4         5         6         7         8 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n        9        10        11        12        13        14        15        16 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n       17        18        19        20        21        22        23        24 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n       25        26        27        28        29        30        31        32 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n       33        34        35        36        37        38        39        40 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n       41        42        43        44        45        46        47        48 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n       49        50        51        52        53        54        55        56 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n       57        58        59        60        61        62        63        64 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n       65        66        67        68        69        70        71        72 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n       73        74        75        76        77        78        79        80 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n       81        82        83        84        85        86        87        88 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n       89        90        91        92        93        94        95        96 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n       97        98        99       100       101       102       103       104 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n      105       106       107       108       109       110       111       112 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n      113       114       115       116       117       118       119       120 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n      121       122       123       124       125       126       127       128 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n      129       130       131       132       133       134       135       136 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n      137       138       139       140       141       142       143       144 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n      145       146       147       148       149       150       151       152 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n      153       154       155       156       157       158       159       160 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n      161       162       163       164       165       166       167       168 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n      169       170       171       172       173       174       175       176 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n      177       178       179       180       181       182       183       184 \n1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 \n      185       191       202       244       257       280       281       282 \n1.0000000 1.2162162 0.4054054 0.4054054 0.4054054 0.4054054 0.4054054 0.4054054 \n      284       295       297       303       312       319       325       335 \n1.6216216 0.8108108 0.4054054 3.6486486 0.4054054 1.6216216 2.4324324 0.4054054 \n      343       344       353       362       364       384       387       403 \n0.4054054 0.8108108 0.4054054 0.4054054 0.8108108 0.4054054 0.4054054 0.8108108 \n      405       409       411       413       420       422       423       432 \n0.4054054 0.4054054 2.0270270 0.8108108 0.4054054 0.4054054 0.4054054 0.4054054 \n      438       450       451       454       463       475       476       493 \n1.6216216 0.4054054 0.8108108 1.2162162 0.4054054 0.4054054 0.4054054 1.2162162 \n      507       511       512       515       516       518       520       524 \n0.4054054 0.4054054 0.4054054 0.4054054 0.8108108 0.8108108 0.8108108 0.4054054 \n      526       530       537       538       539       540       546       551 \n0.4054054 0.4054054 3.2432432 0.8108108 0.4054054 0.8108108 0.4054054 0.4054054 \n      552       553       557       558       559       561       565       566 \n1.6216216 5.2702703 0.8108108 2.8378378 1.2162162 1.6216216 0.4054054 0.4054054 \n      573       576       577       578       584       585       592       597 \n2.4324324 0.4054054 1.6216216 0.4054054 1.2162162 1.2162162 0.8108108 0.8108108 \n      601       604       608       613 \n1.2162162 0.4054054 7.2972973 0.4054054 \n```\n\n\n:::\n:::\n\n\n\n\n　したがって、復元マッチングの場合、`lm()`内に`weights`引数を必ず指定する必要がある。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmh_fit3 <- lm(re78 ~ treat, \n              data = mh_data2, weights = weights)\nmh_fit4 <- lm(re78 ~ treat + age + educ + black + hispanic + married + \n                   nodegree + re74 + re75, \n              data = mh_data2, weights = weights)\n\nmodelsummary(list(\"単回帰・非復元\" = mh_fit1,\n                  \"重回帰・非復元\" = mh_fit2,\n                  \"単回帰・復元\"   = mh_fit3,\n                  \"重回帰・復元\"   = mh_fit4), \n             gof_map   = c(\"nobs\", \"r.squared\", \"adj.r.squared\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n      function styleCell_eu7xatr0nrn5w0cxusru(i, j, css_id) {\n        var table = document.getElementById(\"tinytable_eu7xatr0nrn5w0cxusru\");\n        table.rows[i].cells[j].classList.add(css_id);\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_eu7xatr0nrn5w0cxusru');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_eu7xatr0nrn5w0cxusru(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_eu7xatr0nrn5w0cxusru\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(0, 0, 'tinytable_css_idklnibdt02jinc0ff3h3t') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(0, 1, 'tinytable_css_idz0gkclj8qodjwyw4ba9i') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(0, 2, 'tinytable_css_idz0gkclj8qodjwyw4ba9i') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(0, 3, 'tinytable_css_idz0gkclj8qodjwyw4ba9i') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(0, 4, 'tinytable_css_idz0gkclj8qodjwyw4ba9i') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(1, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(1, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(1, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(1, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(1, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(2, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(2, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(2, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(2, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(2, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(3, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(3, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(3, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(3, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(3, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(4, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(4, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(4, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(4, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(4, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(5, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(5, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(5, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(5, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(5, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(6, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(6, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(6, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(6, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(6, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(7, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(7, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(7, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(7, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(7, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(8, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(8, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(8, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(8, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(8, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(9, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(9, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(9, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(9, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(9, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(10, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(10, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(10, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(10, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(10, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(11, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(11, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(11, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(11, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(11, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(12, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(12, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(12, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(12, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(12, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(13, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(13, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(13, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(13, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(13, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(14, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(14, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(14, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(14, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(14, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(15, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(15, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(15, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(15, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(15, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(16, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(16, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(16, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(16, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(16, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(17, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(17, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(17, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(17, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(17, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(18, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(18, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(18, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(18, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(18, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(19, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(19, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(19, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(19, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(19, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(20, 0, 'tinytable_css_idluar952dznrmwifzesk6') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(20, 1, 'tinytable_css_idhixiysxhbux01n719dr8') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(20, 2, 'tinytable_css_idhixiysxhbux01n719dr8') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(20, 3, 'tinytable_css_idhixiysxhbux01n719dr8') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(20, 4, 'tinytable_css_idhixiysxhbux01n719dr8') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(21, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(21, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(21, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(21, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(21, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(22, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(22, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(22, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(22, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(22, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(23, 0, 'tinytable_css_idpvcllpquifwvzvc1dgkm') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(23, 1, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(23, 2, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(23, 3, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\nwindow.addEventListener('load', function () { styleCell_eu7xatr0nrn5w0cxusru(23, 4, 'tinytable_css_idhkc3gpxuwhwy0eux7654') })\n    </script>\n\n    <style>\n    .table td.tinytable_css_idklnibdt02jinc0ff3h3t, .table th.tinytable_css_idklnibdt02jinc0ff3h3t {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_idz0gkclj8qodjwyw4ba9i, .table th.tinytable_css_idz0gkclj8qodjwyw4ba9i {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_idpvcllpquifwvzvc1dgkm, .table th.tinytable_css_idpvcllpquifwvzvc1dgkm {  text-align: left; }\n    .table td.tinytable_css_idhkc3gpxuwhwy0eux7654, .table th.tinytable_css_idhkc3gpxuwhwy0eux7654 {  text-align: center; }\n    .table td.tinytable_css_idluar952dznrmwifzesk6, .table th.tinytable_css_idluar952dznrmwifzesk6 {  border-bottom: solid 0.05em black;  text-align: left; }\n    .table td.tinytable_css_idhixiysxhbux01n719dr8, .table th.tinytable_css_idhixiysxhbux01n719dr8 {  border-bottom: solid 0.05em black;  text-align: center; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_eu7xatr0nrn5w0cxusru\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">単回帰・非復元</th>\n                <th scope=\"col\">重回帰・非復元</th>\n                <th scope=\"col\">単回帰・復元</th>\n                <th scope=\"col\">重回帰・復元</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>5832.507 </td>\n                  <td>-453.365  </td>\n                  <td>5744.482  </td>\n                  <td>1371.865  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(527.987)</td>\n                  <td>(3546.028)</td>\n                  <td>(854.641) </td>\n                  <td>(4808.980)</td>\n                </tr>\n                <tr>\n                  <td>treat      </td>\n                  <td>516.637  </td>\n                  <td>1239.696  </td>\n                  <td>604.661   </td>\n                  <td>524.037   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(746.686)</td>\n                  <td>(812.039) </td>\n                  <td>(1013.175)</td>\n                  <td>(1011.417)</td>\n                </tr>\n                <tr>\n                  <td>age        </td>\n                  <td>         </td>\n                  <td>15.112    </td>\n                  <td>          </td>\n                  <td>8.365     </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(45.720)  </td>\n                  <td>          </td>\n                  <td>(64.228)  </td>\n                </tr>\n                <tr>\n                  <td>educ       </td>\n                  <td>         </td>\n                  <td>533.042   </td>\n                  <td>          </td>\n                  <td>476.666   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(243.621) </td>\n                  <td>          </td>\n                  <td>(319.397) </td>\n                </tr>\n                <tr>\n                  <td>black      </td>\n                  <td>         </td>\n                  <td>-1158.148 </td>\n                  <td>          </td>\n                  <td>-1562.414 </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(906.948) </td>\n                  <td>          </td>\n                  <td>(1568.526)</td>\n                </tr>\n                <tr>\n                  <td>hispanic   </td>\n                  <td>         </td>\n                  <td>1120.562  </td>\n                  <td>          </td>\n                  <td>-17.586   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(1676.953)</td>\n                  <td>          </td>\n                  <td>(2423.801)</td>\n                </tr>\n                <tr>\n                  <td>married    </td>\n                  <td>         </td>\n                  <td>653.748   </td>\n                  <td>          </td>\n                  <td>330.704   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(984.773) </td>\n                  <td>          </td>\n                  <td>(1285.183)</td>\n                </tr>\n                <tr>\n                  <td>nodegree   </td>\n                  <td>         </td>\n                  <td>-170.705  </td>\n                  <td>          </td>\n                  <td>106.692   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(1116.240)</td>\n                  <td>          </td>\n                  <td>(1421.140)</td>\n                </tr>\n                <tr>\n                  <td>re74       </td>\n                  <td>         </td>\n                  <td>0.071     </td>\n                  <td>          </td>\n                  <td>0.091     </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(0.098)   </td>\n                  <td>          </td>\n                  <td>(0.134)   </td>\n                </tr>\n                <tr>\n                  <td>re75       </td>\n                  <td>         </td>\n                  <td>0.272     </td>\n                  <td>          </td>\n                  <td>0.193     </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>         </td>\n                  <td>(0.155)   </td>\n                  <td>          </td>\n                  <td>(0.208)   </td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.   </td>\n                  <td>370      </td>\n                  <td>370       </td>\n                  <td>260       </td>\n                  <td>260       </td>\n                </tr>\n                <tr>\n                  <td>R2         </td>\n                  <td>0.001    </td>\n                  <td>0.076     </td>\n                  <td>0.001     </td>\n                  <td>0.041     </td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.    </td>\n                  <td>-0.001   </td>\n                  <td>0.053     </td>\n                  <td>-0.002    </td>\n                  <td>0.007     </td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n\n　推定の結果は、いずれも正であり、職業訓練は所得に正の影響を与えるという結果が得られている。しかし、いずれも標準誤差が非常に大きく、統計的に有意な結果は得られていない。\n\n### 傾向スコア\n\n　傾向スコアマッチングも、これまでのコードとほぼ同じだ。マハラノビス最近傍マッチングのコマンドから`distance = ...`引数を抜けば、傾向スコアマッチングができる[^PS1]。ここでも`replace = TRUE`を指定し、復元マッチングをやってみよう。\n\n[^PS1]: 実は`nearest = \"logit\"`が省略されている。つまり、ロジスティック回帰分析から得られた傾向スコアの距離に基づくマッチングを意味する。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nps_mat <- matchit(treat ~ age + educ + black + hispanic + married + \n                    nodegree + re74 + re75, \n                  data = la_df, replace = TRUE,\n                  method = \"nearest\", estimand = \"ATT\")\n```\n:::\n\n\n\n\n　続いて、バランスチェックをしよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlove.plot(ps_mat, thresholds = 0.25, abs = TRUE)\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-31-1.png){fig-align='center' width=1050}\n:::\n:::\n\n\n\n\n　バランスが大幅に改善されていることが分かる。ちなみに最上段の`distance`は傾向スコアを意味する。\n\n　それでは、ATT推定のためにマッチング後のデータを抽出しよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# 傾向スコアマッチング後のデータセットを抽出\nps_data <- match.data(ps_mat)\n```\n:::\n\n\n\n\n　傾向スコアを用いたATTをの推定もこれまでと同様、回帰分析を使用する。ここでも共変量なしの単回帰とありの重回帰を行い、マハラノビス距離最近傍マッチング（復元）と結果を比べてみよう。。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# 処置効果の推定\nps_fit1 <- lm(re78 ~ treat, \n             data = ps_data, weights = weights)\nps_fit2 <- lm(re78 ~ treat + age + educ + black + hispanic + \n                married + nodegree + re74 + re75, \n             data = ps_data, weights = weights)\n\nmodelsummary(list(\"MH (単回帰)\"   = mh_fit3,\n                  \"MH (重回帰)\"   = mh_fit4,\n                  \"PS (単回帰)\"   = ps_fit1,\n                  \"PS (重回帰)\"   = ps_fit2), \n             gof_map   = c(\"nobs\", \"r.squared\", \"adj.r.squared\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n      function styleCell_l117nhtfwilmzjpeff32(i, j, css_id) {\n        var table = document.getElementById(\"tinytable_l117nhtfwilmzjpeff32\");\n        table.rows[i].cells[j].classList.add(css_id);\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_l117nhtfwilmzjpeff32');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_l117nhtfwilmzjpeff32(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_l117nhtfwilmzjpeff32\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(0, 0, 'tinytable_css_idtv7fixkpaorduqtrck2x') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(0, 1, 'tinytable_css_ide06rq0g4kqg3x4anr0jb') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(0, 2, 'tinytable_css_ide06rq0g4kqg3x4anr0jb') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(0, 3, 'tinytable_css_ide06rq0g4kqg3x4anr0jb') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(0, 4, 'tinytable_css_ide06rq0g4kqg3x4anr0jb') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(1, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(1, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(1, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(1, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(1, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(2, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(2, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(2, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(2, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(2, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(3, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(3, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(3, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(3, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(3, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(4, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(4, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(4, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(4, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(4, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(5, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(5, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(5, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(5, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(5, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(6, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(6, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(6, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(6, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(6, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(7, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(7, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(7, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(7, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(7, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(8, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(8, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(8, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(8, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(8, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(9, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(9, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(9, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(9, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(9, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(10, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(10, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(10, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(10, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(10, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(11, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(11, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(11, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(11, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(11, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(12, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(12, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(12, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(12, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(12, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(13, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(13, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(13, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(13, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(13, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(14, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(14, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(14, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(14, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(14, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(15, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(15, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(15, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(15, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(15, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(16, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(16, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(16, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(16, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(16, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(17, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(17, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(17, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(17, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(17, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(18, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(18, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(18, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(18, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(18, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(19, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(19, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(19, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(19, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(19, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(20, 0, 'tinytable_css_id8j41xfc7k1v0nq4ae7ro') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(20, 1, 'tinytable_css_id0b5j11komsi8f5xjqzrt') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(20, 2, 'tinytable_css_id0b5j11komsi8f5xjqzrt') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(20, 3, 'tinytable_css_id0b5j11komsi8f5xjqzrt') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(20, 4, 'tinytable_css_id0b5j11komsi8f5xjqzrt') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(21, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(21, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(21, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(21, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(21, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(22, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(22, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(22, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(22, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(22, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(23, 0, 'tinytable_css_idowalqrf3275z2j9inxv8') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(23, 1, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(23, 2, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(23, 3, 'tinytable_css_id988izyk7nmcy6klaldn4') })\nwindow.addEventListener('load', function () { styleCell_l117nhtfwilmzjpeff32(23, 4, 'tinytable_css_id988izyk7nmcy6klaldn4') })\n    </script>\n\n    <style>\n    .table td.tinytable_css_idtv7fixkpaorduqtrck2x, .table th.tinytable_css_idtv7fixkpaorduqtrck2x {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_ide06rq0g4kqg3x4anr0jb, .table th.tinytable_css_ide06rq0g4kqg3x4anr0jb {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_idowalqrf3275z2j9inxv8, .table th.tinytable_css_idowalqrf3275z2j9inxv8 {  text-align: left; }\n    .table td.tinytable_css_id988izyk7nmcy6klaldn4, .table th.tinytable_css_id988izyk7nmcy6klaldn4 {  text-align: center; }\n    .table td.tinytable_css_id8j41xfc7k1v0nq4ae7ro, .table th.tinytable_css_id8j41xfc7k1v0nq4ae7ro {  border-bottom: solid 0.05em black;  text-align: left; }\n    .table td.tinytable_css_id0b5j11komsi8f5xjqzrt, .table th.tinytable_css_id0b5j11komsi8f5xjqzrt {  border-bottom: solid 0.05em black;  text-align: center; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_l117nhtfwilmzjpeff32\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">MH (単回帰)</th>\n                <th scope=\"col\">MH (重回帰)</th>\n                <th scope=\"col\">PS (単回帰)</th>\n                <th scope=\"col\">PS (重回帰)</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>5744.482  </td>\n                  <td>1371.865  </td>\n                  <td>4357.528 </td>\n                  <td>-1268.481 </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(854.641) </td>\n                  <td>(4808.980)</td>\n                  <td>(798.432)</td>\n                  <td>(4329.104)</td>\n                </tr>\n                <tr>\n                  <td>treat      </td>\n                  <td>604.661   </td>\n                  <td>524.037   </td>\n                  <td>1991.615 </td>\n                  <td>1926.426  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(1013.175)</td>\n                  <td>(1011.417)</td>\n                  <td>(959.197)</td>\n                  <td>(962.213) </td>\n                </tr>\n                <tr>\n                  <td>age        </td>\n                  <td>          </td>\n                  <td>8.365     </td>\n                  <td>         </td>\n                  <td>43.983    </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(64.228)  </td>\n                  <td>         </td>\n                  <td>(59.595)  </td>\n                </tr>\n                <tr>\n                  <td>educ       </td>\n                  <td>          </td>\n                  <td>476.666   </td>\n                  <td>         </td>\n                  <td>462.507   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(319.397) </td>\n                  <td>         </td>\n                  <td>(275.406) </td>\n                </tr>\n                <tr>\n                  <td>black      </td>\n                  <td>          </td>\n                  <td>-1562.414 </td>\n                  <td>         </td>\n                  <td>-892.421  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(1568.526)</td>\n                  <td>         </td>\n                  <td>(1526.070)</td>\n                </tr>\n                <tr>\n                  <td>hispanic   </td>\n                  <td>          </td>\n                  <td>-17.586   </td>\n                  <td>         </td>\n                  <td>-171.481  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(2423.801)</td>\n                  <td>         </td>\n                  <td>(2323.016)</td>\n                </tr>\n                <tr>\n                  <td>married    </td>\n                  <td>          </td>\n                  <td>330.704   </td>\n                  <td>         </td>\n                  <td>282.877   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(1285.183)</td>\n                  <td>         </td>\n                  <td>(1282.599)</td>\n                </tr>\n                <tr>\n                  <td>nodegree   </td>\n                  <td>          </td>\n                  <td>106.692   </td>\n                  <td>         </td>\n                  <td>159.611   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(1421.140)</td>\n                  <td>         </td>\n                  <td>(1367.608)</td>\n                </tr>\n                <tr>\n                  <td>re74       </td>\n                  <td>          </td>\n                  <td>0.091     </td>\n                  <td>         </td>\n                  <td>0.056     </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(0.134)   </td>\n                  <td>         </td>\n                  <td>(0.121)   </td>\n                </tr>\n                <tr>\n                  <td>re75       </td>\n                  <td>          </td>\n                  <td>0.193     </td>\n                  <td>         </td>\n                  <td>0.163     </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(0.208)   </td>\n                  <td>         </td>\n                  <td>(0.198)   </td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.   </td>\n                  <td>260       </td>\n                  <td>260       </td>\n                  <td>267      </td>\n                  <td>267       </td>\n                </tr>\n                <tr>\n                  <td>R2         </td>\n                  <td>0.001     </td>\n                  <td>0.041     </td>\n                  <td>0.016    </td>\n                  <td>0.053     </td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.    </td>\n                  <td>-0.002    </td>\n                  <td>0.007     </td>\n                  <td>0.012    </td>\n                  <td>0.020     </td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n\n　傾向スコアマッチングでも正の処置効果（ATT）が確認され、今回は統計的に有意な結果が得られている。\n\n### CEM\n\n　Coarsened Exact Matching（CEM）はマハラノビス最近傍マッチング同様、`matchit()`関数を使うが、事前に{cem}パッケージをインストールしておく必要がある（`install.pacakges(\"cem\")`）。\n\n　CEMのようなExact Matching類の手法は距離を図る必要がないので、`distance`引数は不要である。マッチング方法を指定する`method`引数はこれまで使ってきた`\"nearest\"`（最近傍）でなく、`\"cem\"`に替えよう。推定可能な処置効果はATE（最近傍マッチングでは指定できなかったもの）、ATT、ATCであるが、ここではAT**T**を推定してみよう。\n\n　マッチングをしたら`match.data()`でマッチングされたデータを抽出する。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncem_mat <- matchit(treat ~ age + educ + black + hispanic + married + \n                     nodegree + re74 + re75, data = la_df,\n                   method = \"cem\", estimand = \"ATT\")\n```\n:::\n\n\n\n\n　つづいて、{cobalt}の`love.plot()`を使用して、バランスチェックを行う。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlove.plot(cem_mat, thresholds = 0.25, abs = TRUE)\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-35-1.png){fig-align='center' width=1050}\n:::\n:::\n\n\n\n\n　CEMの場合、（非復元）最近傍マッチングよりもバランスが大きく改善されることが分かる。その理由は簡単だ。最近傍マッチングの場合、最も近いケースであれば、どれほど離れていてもマッチングされる。一方、CEMは正確マッチングの一種であるため、ある程度離れているケースを捨ててしまうため、結局は共変量が非常に近いケースのみを残すことになります。\n\n　それでは、`match.data()`関数を使ってマッチング後のデータを抽出してみよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncem_data <- match.data(cem_mat)\n\ncem_data\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 140 × 13\n   treat   age  educ black hispanic white married nodegree  re74  re75   re78\n   <int> <int> <int> <int>    <int> <int>   <int>    <int> <dbl> <dbl>  <dbl>\n 1     1    22     9     0        1     0       0        1     0     0  3596.\n 2     1    27    11     1        0     0       0        1     0     0  7506.\n 3     1    22     9     1        0     0       0        1     0     0  4056.\n 4     1    23    12     1        0     0       0        0     0     0     0 \n 5     1    22    16     1        0     0       0        0     0     0  2164.\n 6     1    19     9     1        0     0       0        1     0     0  8174.\n 7     1    21    13     1        0     0       0        0     0     0 17095.\n 8     1    18     8     1        0     0       0        1     0     0     0 \n 9     1    17     7     1        0     0       0        1     0     0  3024.\n10     1    19    10     1        0     0       0        1     0     0  3229.\n# ℹ 130 more rows\n# ℹ 2 more variables: weights <dbl>, subclass <fct>\n```\n\n\n:::\n:::\n\n\n\n\n　CEMの場合、マッチングされないブロックは捨てられるため、マハラノビス距離最近傍マッチングよりもサンプルサイズが小さくなりやすい。マッチング相手がなければ、たとえ処置群だとしても除外される。また、処置群と統制群のサンプルサイズも不均衡になる。マッチング結果を見ると、処置群からは65ケース、統制群からは75サンプルのみ残っている。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncem_data |>\n  count(treat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  treat     n\n  <int> <int>\n1     0    75\n2     1    65\n```\n\n\n:::\n:::\n\n\n\n\n　処置効果はこれまでの復元マッチングと同様、重み付き回帰分析で推定するｙ。ここでも共変量ありとなし、2パターンで推定してみよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncem_fit1 <- lm(re78 ~ treat, \n               data = cem_data, weights = weights)\ncem_fit2 <- lm(re78 ~ treat + age + educ + black + hispanic +\n                 married + nodegree + re74 + re75, \n               data = cem_data, weights = weights)\n\nmodelsummary(list(\"MH (単回帰)\"   = mh_fit3,\n                  \"MH (重回帰)\"   = mh_fit4,\n                  \"PS (単回帰)\"   = ps_fit1,\n                  \"PS (重回帰)\"   = ps_fit2,\n                  \"CEM (単回帰)\"  = cem_fit1,\n                  \"CEM (重回帰)\"  = cem_fit2), \n             gof_map   = c(\"nobs\", \"r.squared\", \"adj.r.squared\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n      function styleCell_9w64tjia62as8vi543dk(i, j, css_id) {\n        var table = document.getElementById(\"tinytable_9w64tjia62as8vi543dk\");\n        table.rows[i].cells[j].classList.add(css_id);\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_9w64tjia62as8vi543dk');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_9w64tjia62as8vi543dk(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_9w64tjia62as8vi543dk\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(0, 0, 'tinytable_css_idw1yaqp762uo15cgdnlh3') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(0, 1, 'tinytable_css_idylg20ju0oaxl6vzemwmk') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(0, 2, 'tinytable_css_idylg20ju0oaxl6vzemwmk') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(0, 3, 'tinytable_css_idylg20ju0oaxl6vzemwmk') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(0, 4, 'tinytable_css_idylg20ju0oaxl6vzemwmk') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(0, 5, 'tinytable_css_idylg20ju0oaxl6vzemwmk') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(0, 6, 'tinytable_css_idylg20ju0oaxl6vzemwmk') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(1, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(1, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(1, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(1, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(1, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(1, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(1, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(2, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(2, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(2, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(2, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(2, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(2, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(2, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(3, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(3, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(3, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(3, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(3, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(3, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(3, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(4, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(4, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(4, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(4, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(4, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(4, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(4, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(5, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(5, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(5, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(5, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(5, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(5, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(5, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(6, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(6, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(6, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(6, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(6, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(6, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(6, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(7, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(7, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(7, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(7, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(7, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(7, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(7, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(8, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(8, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(8, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(8, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(8, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(8, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(8, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(9, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(9, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(9, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(9, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(9, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(9, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(9, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(10, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(10, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(10, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(10, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(10, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(10, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(10, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(11, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(11, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(11, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(11, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(11, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(11, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(11, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(12, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(12, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(12, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(12, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(12, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(12, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(12, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(13, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(13, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(13, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(13, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(13, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(13, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(13, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(14, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(14, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(14, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(14, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(14, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(14, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(14, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(15, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(15, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(15, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(15, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(15, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(15, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(15, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(16, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(16, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(16, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(16, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(16, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(16, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(16, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(17, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(17, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(17, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(17, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(17, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(17, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(17, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(18, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(18, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(18, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(18, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(18, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(18, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(18, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(19, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(19, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(19, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(19, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(19, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(19, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(19, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(20, 0, 'tinytable_css_id108ewse1yqmgwkzqrt65') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(20, 1, 'tinytable_css_iddxxpt6zyaliyupln7far') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(20, 2, 'tinytable_css_iddxxpt6zyaliyupln7far') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(20, 3, 'tinytable_css_iddxxpt6zyaliyupln7far') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(20, 4, 'tinytable_css_iddxxpt6zyaliyupln7far') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(20, 5, 'tinytable_css_iddxxpt6zyaliyupln7far') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(20, 6, 'tinytable_css_iddxxpt6zyaliyupln7far') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(21, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(21, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(21, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(21, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(21, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(21, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(21, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(22, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(22, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(22, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(22, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(22, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(22, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(22, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(23, 0, 'tinytable_css_id0femxlvm44m3eam5csym') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(23, 1, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(23, 2, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(23, 3, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(23, 4, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(23, 5, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\nwindow.addEventListener('load', function () { styleCell_9w64tjia62as8vi543dk(23, 6, 'tinytable_css_idvf9jmuld3aebxm8j7wbz') })\n    </script>\n\n    <style>\n    .table td.tinytable_css_idw1yaqp762uo15cgdnlh3, .table th.tinytable_css_idw1yaqp762uo15cgdnlh3 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_idylg20ju0oaxl6vzemwmk, .table th.tinytable_css_idylg20ju0oaxl6vzemwmk {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_id0femxlvm44m3eam5csym, .table th.tinytable_css_id0femxlvm44m3eam5csym {  text-align: left; }\n    .table td.tinytable_css_idvf9jmuld3aebxm8j7wbz, .table th.tinytable_css_idvf9jmuld3aebxm8j7wbz {  text-align: center; }\n    .table td.tinytable_css_id108ewse1yqmgwkzqrt65, .table th.tinytable_css_id108ewse1yqmgwkzqrt65 {  border-bottom: solid 0.05em black;  text-align: left; }\n    .table td.tinytable_css_iddxxpt6zyaliyupln7far, .table th.tinytable_css_iddxxpt6zyaliyupln7far {  border-bottom: solid 0.05em black;  text-align: center; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_9w64tjia62as8vi543dk\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">MH (単回帰)</th>\n                <th scope=\"col\">MH (重回帰)</th>\n                <th scope=\"col\">PS (単回帰)</th>\n                <th scope=\"col\">PS (重回帰)</th>\n                <th scope=\"col\">CEM (単回帰)</th>\n                <th scope=\"col\">CEM (重回帰)</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>5744.482  </td>\n                  <td>1371.865  </td>\n                  <td>4357.528 </td>\n                  <td>-1268.481 </td>\n                  <td>5265.785  </td>\n                  <td>-7253.717 </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(854.641) </td>\n                  <td>(4808.980)</td>\n                  <td>(798.432)</td>\n                  <td>(4329.104)</td>\n                  <td>(850.457) </td>\n                  <td>(7031.576)</td>\n                </tr>\n                <tr>\n                  <td>treat      </td>\n                  <td>604.661   </td>\n                  <td>524.037   </td>\n                  <td>1991.615 </td>\n                  <td>1926.426  </td>\n                  <td>1070.907  </td>\n                  <td>1207.183  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(1013.175)</td>\n                  <td>(1011.417)</td>\n                  <td>(959.197)</td>\n                  <td>(962.213) </td>\n                  <td>(1248.129)</td>\n                  <td>(1245.959)</td>\n                </tr>\n                <tr>\n                  <td>age        </td>\n                  <td>          </td>\n                  <td>8.365     </td>\n                  <td>         </td>\n                  <td>43.983    </td>\n                  <td>          </td>\n                  <td>147.970   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(64.228)  </td>\n                  <td>         </td>\n                  <td>(59.595)  </td>\n                  <td>          </td>\n                  <td>(107.716) </td>\n                </tr>\n                <tr>\n                  <td>educ       </td>\n                  <td>          </td>\n                  <td>476.666   </td>\n                  <td>         </td>\n                  <td>462.507   </td>\n                  <td>          </td>\n                  <td>879.978   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(319.397) </td>\n                  <td>         </td>\n                  <td>(275.406) </td>\n                  <td>          </td>\n                  <td>(472.982) </td>\n                </tr>\n                <tr>\n                  <td>black      </td>\n                  <td>          </td>\n                  <td>-1562.414 </td>\n                  <td>         </td>\n                  <td>-892.421  </td>\n                  <td>          </td>\n                  <td>-1941.465 </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(1568.526)</td>\n                  <td>         </td>\n                  <td>(1526.070)</td>\n                  <td>          </td>\n                  <td>(2485.215)</td>\n                </tr>\n                <tr>\n                  <td>hispanic   </td>\n                  <td>          </td>\n                  <td>-17.586   </td>\n                  <td>         </td>\n                  <td>-171.481  </td>\n                  <td>          </td>\n                  <td>437.208   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(2423.801)</td>\n                  <td>         </td>\n                  <td>(2323.016)</td>\n                  <td>          </td>\n                  <td>(4223.958)</td>\n                </tr>\n                <tr>\n                  <td>married    </td>\n                  <td>          </td>\n                  <td>330.704   </td>\n                  <td>         </td>\n                  <td>282.877   </td>\n                  <td>          </td>\n                  <td>-3213.470 </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(1285.183)</td>\n                  <td>         </td>\n                  <td>(1282.599)</td>\n                  <td>          </td>\n                  <td>(4445.151)</td>\n                </tr>\n                <tr>\n                  <td>nodegree   </td>\n                  <td>          </td>\n                  <td>106.692   </td>\n                  <td>         </td>\n                  <td>159.611   </td>\n                  <td>          </td>\n                  <td>1779.900  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(1421.140)</td>\n                  <td>         </td>\n                  <td>(1367.608)</td>\n                  <td>          </td>\n                  <td>(2019.035)</td>\n                </tr>\n                <tr>\n                  <td>re74       </td>\n                  <td>          </td>\n                  <td>0.091     </td>\n                  <td>         </td>\n                  <td>0.056     </td>\n                  <td>          </td>\n                  <td>-0.262    </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(0.134)   </td>\n                  <td>         </td>\n                  <td>(0.121)   </td>\n                  <td>          </td>\n                  <td>(0.601)   </td>\n                </tr>\n                <tr>\n                  <td>re75       </td>\n                  <td>          </td>\n                  <td>0.193     </td>\n                  <td>         </td>\n                  <td>0.163     </td>\n                  <td>          </td>\n                  <td>2.034     </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(0.208)   </td>\n                  <td>         </td>\n                  <td>(0.198)   </td>\n                  <td>          </td>\n                  <td>(0.883)   </td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.   </td>\n                  <td>260       </td>\n                  <td>260       </td>\n                  <td>267      </td>\n                  <td>267       </td>\n                  <td>140       </td>\n                  <td>140       </td>\n                </tr>\n                <tr>\n                  <td>R2         </td>\n                  <td>0.001     </td>\n                  <td>0.041     </td>\n                  <td>0.016    </td>\n                  <td>0.053     </td>\n                  <td>0.005     </td>\n                  <td>0.079     </td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.    </td>\n                  <td>-0.002    </td>\n                  <td>0.007     </td>\n                  <td>0.012    </td>\n                  <td>0.020     </td>\n                  <td>-0.002    </td>\n                  <td>0.015     </td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n\n　推定の結果は、いずれも正であり、職業訓練は所得に正の影響を与えるという結果が得られている。しかし、いずれも標準誤差が非常に大きく、統計的に有意な結果は得られていない。\n\n## IPW\n\n　最後に、{WeightIt}パッケージを使ってIPW推定を行ってみよう。このパッケージはこれまで使ってた{MatchIt}パッケージと非常に似ている。まず、第一引数として処置変数を結果変数、処置有無に影響を与えると考えられる共変量を説明変数とした回帰式を入れる。続いて、データ（`data`）、IPW算出の方法（`method`）、推定の対象（`estimand`）を指定する。データは`data = la_df`とし、傾向スコアからIPWを算出するため`method = \"ps\"`を指定、最後にATT推定のために`estimand = \"ATT\"`を指定する。今回はIPW算出のために今回は傾向スコアを使うが、「処置を受ける確率」が計算できるなら何でも良い。たとえば、Imai and Ratkovic (2014)[^imai-ratkovic]が推奨しているCovariate Balancing Propensity Score (CBPS) を使用する場合は`\"ps\"`の代わりに`\"cbps\"`を、複数の推定を組み合わせるスーパーラーニングをする場合は`\"super\"`[^super]などが使える。他にもエントロピーバランシングなど様々なオプションが提供されている。\n\n[^imai-ratkovic]: [Imai, Kosuke and Marc Ratkovic. 2014. \"Covariate Balancing Propensity Score.\" *Journal of the Royal Statistical Society, Series B,* Vol. 76, No. 1, pp. 243-246.](https://imai.fas.harvard.edu/research/CBPS.html)\n\n[^super]: Super Learnerを使った例は「[Cyrus, Samii, Laura Paler, and Sarah Zukerman Daly. 2016. \"Retrospective Causal Inference with Machine Learning Ensembles: An Application to Anti-recidivism Policies in Colombia.\" *Political Analysis,* 22 (4) pp. 434-456]()」を、日本語による解説は[誰か](https://www.jaysong.net)の[報告スライド](https://www.slideshare.net/tintstyle/review-cyrus-samii-laura-paler-and-sarah-zukerman-daly-2016-retrospective-causal-inference-with-machine-learning-ensembles-an-application-to-antirecidivism-policies-in-colombia-political-analysis-22-4-pp-434456)を参照して下さい。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nipw_data <- weightit(treat ~ age + educ + black + hispanic + \n                       married + nodegree + re74 + re75, \n                     data = la_df, method = \"ps\", estimand = \"ATT\")\n```\n:::\n\n\n\n\n　`matchit()`とは違って、別途`match.data()`などの関数は不要である。`weightit()`パッケージを使うと、IPW推定のための重み変数を返してくれる。また、`weightit()`から得られたデータは{cobalt}でバランスチェックもできる。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlove.plot(ipw_data, thresholds = 0.25, abs = TRUE)\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-40-1.png){fig-align='center' width=1050}\n:::\n:::\n\n\n\n\n　読み方は最近傍マッチング（傾向スコア）と同じである。ここでもバランスが大幅に改善されていることが分かる。\n\n　それではIPW推定量を計算してみよう。ここで一つ注意が必要だ。それは`data`を`ipw_data`でなく、元のデータである`la_df`を使うという点だ。また、重み変数は`la_df`には含まれていないため、`ipw_data$weights`を使う必要がある。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nipw_fit1 <- lm(re78 ~ treat, \n               data = la_df, weights = ipw_data$weights)\nipw_fit2 <- lm(re78 ~ treat + age + educ + black + hispanic + \n                       married + nodegree + re74 + re75, \n               data = la_df, weights = ipw_data$weights)\n\nmodelsummary(list(\"MH (単)\"   = mh_fit3,\n                  \"MH (重)\"   = mh_fit4,\n                  \"PS (単)\"   = ps_fit1,\n                  \"PS (重)\"   = ps_fit2,\n                  \"CEM (単)\"  = cem_fit1,\n                  \"CEM (重)\"  = cem_fit2,\n                  \"IPW (単)\"  = ipw_fit1,\n                  \"IPW (重)\"  = ipw_fit2), \n             gof_map   = c(\"nobs\", \"r.squared\", \"adj.r.squared\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n      function styleCell_xyn80vd2tqbcirhl859o(i, j, css_id) {\n        var table = document.getElementById(\"tinytable_xyn80vd2tqbcirhl859o\");\n        table.rows[i].cells[j].classList.add(css_id);\n      }\n      function insertSpanRow(i, colspan, content) {\n        var table = document.getElementById('tinytable_xyn80vd2tqbcirhl859o');\n        var newRow = table.insertRow(i);\n        var newCell = newRow.insertCell(0);\n        newCell.setAttribute(\"colspan\", colspan);\n        // newCell.innerText = content;\n        // this may be unsafe, but innerText does not interpret <br>\n        newCell.innerHTML = content;\n      }\n      function spanCell_xyn80vd2tqbcirhl859o(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_xyn80vd2tqbcirhl859o\");\n        const targetRow = table.rows[i];\n        const targetCell = targetRow.cells[j];\n        for (let r = 0; r < rowspan; r++) {\n          // Only start deleting cells to the right for the first row (r == 0)\n          if (r === 0) {\n            // Delete cells to the right of the target cell in the first row\n            for (let c = colspan - 1; c > 0; c--) {\n              if (table.rows[i + r].cells[j + c]) {\n                table.rows[i + r].deleteCell(j + c);\n              }\n            }\n          }\n          // For rows below the first, delete starting from the target column\n          if (r > 0) {\n            for (let c = colspan - 1; c >= 0; c--) {\n              if (table.rows[i + r] && table.rows[i + r].cells[j]) {\n                table.rows[i + r].deleteCell(j);\n              }\n            }\n          }\n        }\n        // Set rowspan and colspan of the target cell\n        targetCell.rowSpan = rowspan;\n        targetCell.colSpan = colspan;\n      }\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(0, 0, 'tinytable_css_idkm6y3nax1fgr9o7qsh83') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(0, 1, 'tinytable_css_id6dz9qwt55ydi44lc59l2') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(0, 2, 'tinytable_css_id6dz9qwt55ydi44lc59l2') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(0, 3, 'tinytable_css_id6dz9qwt55ydi44lc59l2') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(0, 4, 'tinytable_css_id6dz9qwt55ydi44lc59l2') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(0, 5, 'tinytable_css_id6dz9qwt55ydi44lc59l2') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(0, 6, 'tinytable_css_id6dz9qwt55ydi44lc59l2') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(0, 7, 'tinytable_css_id6dz9qwt55ydi44lc59l2') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(0, 8, 'tinytable_css_id6dz9qwt55ydi44lc59l2') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(1, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(1, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(1, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(1, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(1, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(1, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(1, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(1, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(1, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(2, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(2, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(2, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(2, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(2, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(2, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(2, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(2, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(2, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(3, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(3, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(3, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(3, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(3, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(3, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(3, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(3, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(3, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(4, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(4, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(4, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(4, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(4, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(4, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(4, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(4, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(4, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(5, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(5, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(5, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(5, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(5, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(5, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(5, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(5, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(5, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(6, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(6, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(6, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(6, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(6, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(6, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(6, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(6, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(6, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(7, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(7, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(7, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(7, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(7, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(7, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(7, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(7, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(7, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(8, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(8, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(8, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(8, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(8, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(8, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(8, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(8, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(8, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(9, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(9, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(9, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(9, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(9, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(9, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(9, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(9, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(9, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(10, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(10, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(10, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(10, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(10, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(10, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(10, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(10, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(10, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(11, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(11, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(11, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(11, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(11, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(11, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(11, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(11, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(11, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(12, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(12, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(12, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(12, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(12, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(12, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(12, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(12, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(12, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(13, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(13, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(13, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(13, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(13, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(13, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(13, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(13, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(13, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(14, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(14, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(14, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(14, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(14, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(14, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(14, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(14, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(14, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(15, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(15, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(15, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(15, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(15, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(15, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(15, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(15, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(15, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(16, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(16, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(16, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(16, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(16, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(16, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(16, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(16, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(16, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(17, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(17, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(17, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(17, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(17, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(17, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(17, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(17, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(17, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(18, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(18, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(18, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(18, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(18, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(18, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(18, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(18, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(18, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(19, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(19, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(19, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(19, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(19, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(19, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(19, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(19, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(19, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(20, 0, 'tinytable_css_ide1j39vsgy6xgof80kecy') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(20, 1, 'tinytable_css_idg33r7ntj28gvh1tpgd87') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(20, 2, 'tinytable_css_idg33r7ntj28gvh1tpgd87') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(20, 3, 'tinytable_css_idg33r7ntj28gvh1tpgd87') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(20, 4, 'tinytable_css_idg33r7ntj28gvh1tpgd87') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(20, 5, 'tinytable_css_idg33r7ntj28gvh1tpgd87') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(20, 6, 'tinytable_css_idg33r7ntj28gvh1tpgd87') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(20, 7, 'tinytable_css_idg33r7ntj28gvh1tpgd87') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(20, 8, 'tinytable_css_idg33r7ntj28gvh1tpgd87') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(21, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(21, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(21, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(21, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(21, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(21, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(21, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(21, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(21, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(22, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(22, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(22, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(22, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(22, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(22, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(22, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(22, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(22, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(23, 0, 'tinytable_css_id1xh470gsyzgjlr9vkdac') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(23, 1, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(23, 2, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(23, 3, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(23, 4, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(23, 5, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(23, 6, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(23, 7, 'tinytable_css_idk852lqvc817kga2if95x') })\nwindow.addEventListener('load', function () { styleCell_xyn80vd2tqbcirhl859o(23, 8, 'tinytable_css_idk852lqvc817kga2if95x') })\n    </script>\n\n    <style>\n    .table td.tinytable_css_idkm6y3nax1fgr9o7qsh83, .table th.tinytable_css_idkm6y3nax1fgr9o7qsh83 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_id6dz9qwt55ydi44lc59l2, .table th.tinytable_css_id6dz9qwt55ydi44lc59l2 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }\n    .table td.tinytable_css_id1xh470gsyzgjlr9vkdac, .table th.tinytable_css_id1xh470gsyzgjlr9vkdac {  text-align: left; }\n    .table td.tinytable_css_idk852lqvc817kga2if95x, .table th.tinytable_css_idk852lqvc817kga2if95x {  text-align: center; }\n    .table td.tinytable_css_ide1j39vsgy6xgof80kecy, .table th.tinytable_css_ide1j39vsgy6xgof80kecy {  border-bottom: solid 0.05em black;  text-align: left; }\n    .table td.tinytable_css_idg33r7ntj28gvh1tpgd87, .table th.tinytable_css_idg33r7ntj28gvh1tpgd87 {  border-bottom: solid 0.05em black;  text-align: center; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_xyn80vd2tqbcirhl859o\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\"> </th>\n                <th scope=\"col\">MH (単)</th>\n                <th scope=\"col\">MH (重)</th>\n                <th scope=\"col\">PS (単)</th>\n                <th scope=\"col\">PS (重)</th>\n                <th scope=\"col\">CEM (単)</th>\n                <th scope=\"col\">CEM (重)</th>\n                <th scope=\"col\">IPW (単)</th>\n                <th scope=\"col\">IPW (重)</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td>(Intercept)</td>\n                  <td>5744.482  </td>\n                  <td>1371.865  </td>\n                  <td>4357.528 </td>\n                  <td>-1268.481 </td>\n                  <td>5265.785  </td>\n                  <td>-7253.717 </td>\n                  <td>5135.072 </td>\n                  <td>853.666   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(854.641) </td>\n                  <td>(4808.980)</td>\n                  <td>(798.432)</td>\n                  <td>(4329.104)</td>\n                  <td>(850.457) </td>\n                  <td>(7031.576)</td>\n                  <td>(401.194)</td>\n                  <td>(2708.329)</td>\n                </tr>\n                <tr>\n                  <td>treat      </td>\n                  <td>604.661   </td>\n                  <td>524.037   </td>\n                  <td>1991.615 </td>\n                  <td>1926.426  </td>\n                  <td>1070.907  </td>\n                  <td>1207.183  </td>\n                  <td>1214.071 </td>\n                  <td>1237.405  </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>(1013.175)</td>\n                  <td>(1011.417)</td>\n                  <td>(959.197)</td>\n                  <td>(962.213) </td>\n                  <td>(1248.129)</td>\n                  <td>(1245.959)</td>\n                  <td>(568.904)</td>\n                  <td>(554.929) </td>\n                </tr>\n                <tr>\n                  <td>age        </td>\n                  <td>          </td>\n                  <td>8.365     </td>\n                  <td>         </td>\n                  <td>43.983    </td>\n                  <td>          </td>\n                  <td>147.970   </td>\n                  <td>         </td>\n                  <td>-17.562   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(64.228)  </td>\n                  <td>         </td>\n                  <td>(59.595)  </td>\n                  <td>          </td>\n                  <td>(107.716) </td>\n                  <td>         </td>\n                  <td>(33.570)  </td>\n                </tr>\n                <tr>\n                  <td>educ       </td>\n                  <td>          </td>\n                  <td>476.666   </td>\n                  <td>         </td>\n                  <td>462.507   </td>\n                  <td>          </td>\n                  <td>879.978   </td>\n                  <td>         </td>\n                  <td>489.248   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(319.397) </td>\n                  <td>         </td>\n                  <td>(275.406) </td>\n                  <td>          </td>\n                  <td>(472.982) </td>\n                  <td>         </td>\n                  <td>(172.550) </td>\n                </tr>\n                <tr>\n                  <td>black      </td>\n                  <td>          </td>\n                  <td>-1562.414 </td>\n                  <td>         </td>\n                  <td>-892.421  </td>\n                  <td>          </td>\n                  <td>-1941.465 </td>\n                  <td>         </td>\n                  <td>-1149.368 </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(1568.526)</td>\n                  <td>         </td>\n                  <td>(1526.070)</td>\n                  <td>          </td>\n                  <td>(2485.215)</td>\n                  <td>         </td>\n                  <td>(950.708) </td>\n                </tr>\n                <tr>\n                  <td>hispanic   </td>\n                  <td>          </td>\n                  <td>-17.586   </td>\n                  <td>         </td>\n                  <td>-171.481  </td>\n                  <td>          </td>\n                  <td>437.208   </td>\n                  <td>         </td>\n                  <td>202.126   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(2423.801)</td>\n                  <td>         </td>\n                  <td>(2323.016)</td>\n                  <td>          </td>\n                  <td>(4223.958)</td>\n                  <td>         </td>\n                  <td>(1463.378)</td>\n                </tr>\n                <tr>\n                  <td>married    </td>\n                  <td>          </td>\n                  <td>330.704   </td>\n                  <td>         </td>\n                  <td>282.877   </td>\n                  <td>          </td>\n                  <td>-3213.470 </td>\n                  <td>         </td>\n                  <td>424.461   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(1285.183)</td>\n                  <td>         </td>\n                  <td>(1282.599)</td>\n                  <td>          </td>\n                  <td>(4445.151)</td>\n                  <td>         </td>\n                  <td>(807.171) </td>\n                </tr>\n                <tr>\n                  <td>nodegree   </td>\n                  <td>          </td>\n                  <td>106.692   </td>\n                  <td>         </td>\n                  <td>159.611   </td>\n                  <td>          </td>\n                  <td>1779.900  </td>\n                  <td>         </td>\n                  <td>-92.470   </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(1421.140)</td>\n                  <td>         </td>\n                  <td>(1367.608)</td>\n                  <td>          </td>\n                  <td>(2019.035)</td>\n                  <td>         </td>\n                  <td>(844.246) </td>\n                </tr>\n                <tr>\n                  <td>re74       </td>\n                  <td>          </td>\n                  <td>0.091     </td>\n                  <td>         </td>\n                  <td>0.056     </td>\n                  <td>          </td>\n                  <td>-0.262    </td>\n                  <td>         </td>\n                  <td>0.050     </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(0.134)   </td>\n                  <td>         </td>\n                  <td>(0.121)   </td>\n                  <td>          </td>\n                  <td>(0.601)   </td>\n                  <td>         </td>\n                  <td>(0.078)   </td>\n                </tr>\n                <tr>\n                  <td>re75       </td>\n                  <td>          </td>\n                  <td>0.193     </td>\n                  <td>         </td>\n                  <td>0.163     </td>\n                  <td>          </td>\n                  <td>2.034     </td>\n                  <td>         </td>\n                  <td>0.318     </td>\n                </tr>\n                <tr>\n                  <td>           </td>\n                  <td>          </td>\n                  <td>(0.208)   </td>\n                  <td>         </td>\n                  <td>(0.198)   </td>\n                  <td>          </td>\n                  <td>(0.883)   </td>\n                  <td>         </td>\n                  <td>(0.121)   </td>\n                </tr>\n                <tr>\n                  <td>Num.Obs.   </td>\n                  <td>260       </td>\n                  <td>260       </td>\n                  <td>267      </td>\n                  <td>267       </td>\n                  <td>140       </td>\n                  <td>140       </td>\n                  <td>614      </td>\n                  <td>614       </td>\n                </tr>\n                <tr>\n                  <td>R2         </td>\n                  <td>0.001     </td>\n                  <td>0.041     </td>\n                  <td>0.016    </td>\n                  <td>0.053     </td>\n                  <td>0.005     </td>\n                  <td>0.079     </td>\n                  <td>0.007    </td>\n                  <td>0.071     </td>\n                </tr>\n                <tr>\n                  <td>R2 Adj.    </td>\n                  <td>-0.002    </td>\n                  <td>0.007     </td>\n                  <td>0.012    </td>\n                  <td>0.020     </td>\n                  <td>-0.002    </td>\n                  <td>0.015     </td>\n                  <td>0.006    </td>\n                  <td>0.057     </td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n\n　IPWの場合、正の処置効果（ATT）が確認され、今回は統計的に有意な結果が得られた。\n\n## バランスチェック\n\n　ここでは標準化差分以外のバランスチェック方法について紹介する。まず、特定の共変量の分布をヒストグラムを用い、マッチング前後で比較する方法だ。これもまた{coblat}パッケージを使用するが、今回は`love.plot()`でなく、`bal.plot()`を使う。\n\n　第1引数は`matchit()`から得られたオブジェクト名、続いて`var.name`にはバランスをチェックする共変量名（傾向スコアの場合は`\"distance\"`）、他は以下のコードの通りに打てばよい。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbal.plot(ps_mat, var.name = \"distance\", which = \"both\",\n         type = \"histogram\", mirror = TRUE)\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-42-1.png){fig-align='center' width=1050}\n:::\n:::\n\n\n\n\n　左がマッチング前、右が後である。また、上部の赤いヒストグラムは統制群、下部の青は処置群を意味する。もし、傾向スコアのバランスが取れているならヒストグラムは上下対称となる。マッチング前だと統制群は傾向スコアの値が小さく、処置群のそれは大きい傾向があったが、マッチング後はほぼ上下対称となっていることからバランスが改善されたことが分かる。\n\n　ちなみに、ヒストグラムが作成できないダミー変数の場合、棒グラフが表示される。読み方は同じであるが、今回は上下対称ではなく、赤い棒と青い棒の高さが一致すればバランスが取れていると確認できる。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbal.plot(ps_mat, var.name = \"black\", which = \"both\",\n         type = \"histogram\", mirror = TRUE)\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-43-1.png){fig-align='center' width=1050}\n:::\n:::\n\n\n\n\n　このようにヒストグラム（棒グラフ）を使うと、一つ一つの変数の図が必要となってくるので、実際の論文には掲載しにくい。それでも分析の段階では一つ一つのバランスを詳細に見ることは重要である。たとえば、傾向スコアマッチングの場合、回答者の年齢（`age`）のバランスは改善されている。本当にそうだろうか。`age`のバランスを確認してみよう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbal.plot(ps_mat, var.name = \"age\", which = \"both\",\n         type = \"histogram\", mirror = TRUE)\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-44-1.png){fig-align='center' width=1050}\n:::\n:::\n\n\n\n\n　改善ところか、改悪されているとも読み取れる。標準化差分は平均値と標準誤差のみに依存するため、分布の情報までは分からない。このような場合は、処置効果の推定の際、共変量を投入して更に調整が必要であることを示唆する。\n\n## 推定値の比較\n\n　これまで見てきたように、同じく「マッチング」とは言っても手法によって結果のばらつきが大きいことが分かる。また、同じ手法であっても復元か、非復元か、1:1マッチングか、1:nマッチングか、CEMならレイヤーをどれほど細かくするかなどによっても結果は大きく変わる。\n\n　ここまで得られた多くの結果から自分にとって都合の良い結果のみを報告するのは、あるいみ研究**不正**に近い。なぜなら、これを逆にいうと自分にとって都合の悪い結果を隠蔽しているものだからだ。したがって、実際の論文にはそれぞれの結果を報告・比較し、その結果を慎重に解釈する必要がある。ここではこれまで推定してきたマッチングの結果を一つの図としてまとめてみよう。\n\n　まずは、{broom}パッケージの`tidy()`関数で回帰分析の結果を表でまとめ、`bind_rows()`を使って一つに統合する。`tidy()`内に`conf.int = TRUE`を入れておくと、95%信頼区間も出してくれるので、今の段階で入れておこう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\natt_df <- bind_rows(list(\"単回帰_最近傍（マハラノビス）\" = tidy(mh_fit3, conf.int = TRUE),\n                         \"重回帰_最近傍（マハラノビス）\" = tidy(mh_fit4, conf.int = TRUE),\n                         \"単回帰_最近傍（傾向スコア）\"   = tidy(ps_fit1, conf.int = TRUE),\n                         \"重回帰_最近傍（傾向スコア）\"   = tidy(ps_fit2, conf.int = TRUE),\n                         \"単回帰_CEM\" = tidy(cem_fit1, conf.int = TRUE),\n                         \"重回帰_CEM\" = tidy(cem_fit2, conf.int = TRUE),\n                         \"単回帰_IPW\" = tidy(ipw_fit1, conf.int = TRUE),\n                         \"重回帰_IPW\" = tidy(ipw_fit2, conf.int = TRUE)),\n                    .id = \"Model\")\n\natt_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 48 × 8\n   Model          term  estimate std.error statistic  p.value conf.low conf.high\n   <chr>          <chr>    <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n 1 単回帰_最近傍… (Int…  5744.       855.    6.72    1.15e-10    4062.     7427.\n 2 単回帰_最近傍… treat   605.      1013.    0.597   5.51e- 1   -1390.     2600.\n 3 重回帰_最近傍… (Int…  1372.      4809.    0.285   7.76e- 1   -8099.    10843.\n 4 重回帰_最近傍… treat   524.      1011.    0.518   6.05e- 1   -1468.     2516.\n 5 重回帰_最近傍… age       8.36      64.2   0.130   8.96e- 1    -118.      135.\n 6 重回帰_最近傍… educ    477.       319.    1.49    1.37e- 1    -152.     1106.\n 7 重回帰_最近傍… black -1562.      1569.   -0.996   3.20e- 1   -4652.     1527.\n 8 重回帰_最近傍… hisp…   -17.6     2424.   -0.00726 9.94e- 1   -4791.     4756.\n 9 重回帰_最近傍… marr…   331.      1285.    0.257   7.97e- 1   -2200.     2862.\n10 重回帰_最近傍… node…   107.      1421.    0.0751  9.40e- 1   -2692.     2906.\n# ℹ 38 more rows\n```\n\n\n:::\n:::\n\n\n\n\n　続いて、処置効果（ATT）を意味する行のみを残す。`term`の値が`\"treat\"`と一致する行が処置効果である。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\natt_df <- att_df |>\n  filter(term == \"treat\")\n\natt_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 8\n  Model            term  estimate std.error statistic p.value conf.low conf.high\n  <chr>            <chr>    <dbl>     <dbl>     <dbl>   <dbl>    <dbl>     <dbl>\n1 単回帰_最近傍（… treat     605.     1013.     0.597  0.551   -1390.      2600.\n2 重回帰_最近傍（… treat     524.     1011.     0.518  0.605   -1468.      2516.\n3 単回帰_最近傍（… treat    1992.      959.     2.08   0.0388    103.      3880.\n4 重回帰_最近傍（… treat    1926.      962.     2.00   0.0463     31.6     3821.\n5 単回帰_CEM       treat    1071.     1248.     0.858  0.392   -1397.      3539.\n6 重回帰_CEM       treat    1207.     1246.     0.969  0.334   -1258.      3672.\n7 単回帰_IPW       treat    1214.      569.     2.13   0.0332     96.8     2331.\n8 重回帰_IPW       treat    1237.      555.     2.23   0.0261    148.      2327.\n```\n\n\n:::\n:::\n\n\n\n\n　ここでは新しく登場した関数を使用する。`separate()`関数は文字列で構成されている列を、特定の文字を基準に列分割する関数である。`Model`行のそれぞれの値は`回帰モデル_マッチングモデル`で構成され、これを`_`文字を基準に`Regression`と`Method`列に分割する。分割する列名は`col`、分割後の列名は`into`、分割の基準となる文字は`sep`に指定する。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\natt_df <- att_df |>\n  separate(col  = Model,\n           into = c(\"Regression\", \"Method\"),\n           sep  = \"_\")\n\natt_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 9\n  Regression Method          term  estimate std.error statistic p.value conf.low\n  <chr>      <chr>           <chr>    <dbl>     <dbl>     <dbl>   <dbl>    <dbl>\n1 単回帰     最近傍（マハラ… treat     605.     1013.     0.597  0.551   -1390. \n2 重回帰     最近傍（マハラ… treat     524.     1011.     0.518  0.605   -1468. \n3 単回帰     最近傍（傾向ス… treat    1992.      959.     2.08   0.0388    103. \n4 重回帰     最近傍（傾向ス… treat    1926.      962.     2.00   0.0463     31.6\n5 単回帰     CEM             treat    1071.     1248.     0.858  0.392   -1397. \n6 重回帰     CEM             treat    1207.     1246.     0.969  0.334   -1258. \n7 単回帰     IPW             treat    1214.      569.     2.13   0.0332     96.8\n8 重回帰     IPW             treat    1237.      555.     2.23   0.0261    148. \n# ℹ 1 more variable: conf.high <dbl>\n```\n\n\n:::\n:::\n\n\n\n\n　後はこのデータを使って作図するだけである。データを`ggplot()`に渡す前に`Regression`と`Method`列をfactor化しておこう。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\natt_df |>\n  mutate(Regression = fct_inorder(Regression),\n         Method     = fct_inorder(Method)) |>\n  ggplot() +\n  geom_pointrange(aes(x = estimate, y = Method,\n                      xmin = conf.low, xmax = conf.high,\n                      color = Regression),\n                  position = position_dodge2(1/2)) +\n  labs(x = \"処置群における処置効果（ATT）\", y = \"\", color = \"モデル\",\n       caption = \"注: マッチングの場合、復元マッチングを行った。\") +\n  theme_bw(base_size = 12)\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-48-1.png){fig-align='center' width=1050}\n:::\n:::\n\n\n\n\n　もし、縦軸の順番を逆にしたい場合は、`fct_rev()`関数で要素の順番を逆にする。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\natt_df |>\n  mutate(Regression = fct_inorder(Regression),\n         Method     = fct_inorder(Method),\n         Method     = fct_rev(Method)) |>\n  ggplot() +\n  geom_vline(xintercept = 0) +\n  geom_pointrange(aes(x = estimate, y = Method,\n                      xmin = conf.low, xmax = conf.high,\n                      color = Regression),\n                  position = position_dodge2(1/2)) +\n  labs(x = \"処置群における処置効果（ATT）\", y = \"\", color = \"モデル\",\n       caption = \"注: マッチングの場合、復元マッチングを行った。\") +\n  theme_bw(base_size = 12)\n```\n\n::: {.cell-output-display}\n![](matching_files/figure-html/unnamed-chunk-49-1.png){fig-align='center' width=1050}\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}